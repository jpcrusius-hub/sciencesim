<!DOCTYPE html>
<html lang="de">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Quiz: Elektrizit√§tslehre Klasse 8</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/lz-string/1.5.0/lz-string.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/qrcodejs/1.0.0/qrcode.min.js"></script>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif; background: #f0f2f5; min-height: 100vh; }
        .screen { display: none; min-height: 100vh; padding: 20px; }
        .screen.active { display: block; }
        .container { max-width: 800px; margin: 0 auto; }
        .setup-header { text-align: center; margin-bottom: 30px; }
        .setup-header h1 { font-size: 1.5em; color: #333; margin-bottom: 10px; }
        .setup-header p { color: #666; }
        .level-grid { display: grid; grid-template-columns: repeat(4, 1fr); gap: 10px; margin-bottom: 30px; }
        .level-btn { padding: 20px 10px; border: 2px solid #ddd; border-radius: 12px; background: white; cursor: pointer; text-align: center; transition: all 0.2s; }
        .level-btn:hover { border-color: #2196f3; }
        .level-btn.selected { border-color: #4caf50; background: #e8f5e9; }
        .level-btn .symbol { font-size: 1.5em; display: block; margin-bottom: 5px; }
        .level-btn .name { font-weight: bold; }
        .level-btn .info { font-size: 0.8em; color: #666; margin-top: 5px; }
        .seat-section { margin-bottom: 30px; }
        .seat-section h3 { margin-bottom: 15px; color: #333; }
        .seat-grid { display: grid; grid-template-columns: repeat(6, 1fr); gap: 8px; }
        .seat-btn { padding: 12px 8px; border: 2px solid #ddd; border-radius: 8px; background: white; cursor: pointer; font-weight: bold; transition: all 0.2s; }
        .seat-btn:hover { border-color: #2196f3; background: #e3f2fd; }
        .seat-btn.selected { border-color: #4caf50; background: #e8f5e9; }
        .start-btn { width: 100%; padding: 18px; font-size: 1.2em; font-weight: bold; border: none; border-radius: 12px; background: linear-gradient(135deg, #4caf50, #45a049); color: white; cursor: pointer; transition: all 0.2s; }
        .start-btn:disabled { background: #ccc; cursor: not-allowed; }
        .start-btn:not(:disabled):hover { transform: translateY(-2px); box-shadow: 0 4px 12px rgba(76,175,80,0.4); }
        .quiz-header { background: white; padding: 15px 20px; border-radius: 12px; margin-bottom: 20px; box-shadow: 0 2px 8px rgba(0,0,0,0.1); }
        .quiz-header-top { display: flex; justify-content: space-between; align-items: center; margin-bottom: 10px; }
        .timer { font-size: 1.4em; font-weight: bold; font-family: monospace; }
        .timer.warning { color: #ff9800; }
        .timer.danger { color: #f44336; animation: pulse 1s infinite; }
        @keyframes pulse { 0%, 100% { opacity: 1; } 50% { opacity: 0.5; } }
        .reset-btn { padding: 8px 12px; border: 1px solid #ddd; border-radius: 6px; background: white; cursor: pointer; }
        .progress-bar { height: 8px; background: #e0e0e0; border-radius: 4px; overflow: hidden; }
        .progress-fill { height: 100%; background: linear-gradient(90deg, #4caf50, #8bc34a); transition: width 0.3s; }
        .progress-text { font-size: 0.85em; color: #666; margin-top: 8px; }
        .question-nav { display: flex; flex-wrap: wrap; gap: 6px; margin-bottom: 20px; }
        .nav-btn { width: 36px; height: 36px; border: 2px solid #ddd; border-radius: 8px; background: white; cursor: pointer; font-weight: bold; font-size: 0.9em; transition: all 0.2s; }
        .nav-btn.current { border-color: #2196f3; background: #e3f2fd; }
        .nav-btn.answered { border-color: #4caf50; background: #e8f5e9; }
        .question-card { background: white; border-radius: 12px; padding: 20px; box-shadow: 0 2px 8px rgba(0,0,0,0.1); margin-bottom: 20px; }
        .question-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 15px; padding-bottom: 15px; border-bottom: 1px solid #eee; }
        .question-number { font-weight: bold; color: #333; }
        .question-points { background: #e3f2fd; color: #1565c0; padding: 4px 12px; border-radius: 20px; font-size: 0.9em; }
        .question-text { font-size: 1.1em; line-height: 1.6; margin-bottom: 20px; }
        .circuit-container { background: #fafafa; border: 1px solid #e0e0e0; padding: 15px; border-radius: 8px; margin: 15px 0; text-align: center; overflow-x: auto; }
        .circuit-container svg { max-width: 100%; height: auto; }
        .options { display: flex; flex-direction: column; gap: 10px; }
        .option { display: flex; align-items: center; padding: 15px; border: 2px solid #e0e0e0; border-radius: 10px; cursor: pointer; transition: all 0.2s; }
        .option:hover { border-color: #2196f3; background: #f5f5f5; }
        .option.selected { border-color: #4caf50; background: #e8f5e9; }
        .option-letter { width: 32px; height: 32px; display: flex; align-items: center; justify-content: center; background: #e0e0e0; border-radius: 50%; margin-right: 12px; font-weight: bold; }
        .option.selected .option-letter { background: #4caf50; color: white; }
        .check-options { display: flex; flex-direction: column; gap: 10px; }
        .check-option { display: flex; align-items: center; padding: 12px 15px; border: 2px solid #e0e0e0; border-radius: 10px; cursor: pointer; transition: all 0.2s; }
        .check-option:hover { border-color: #2196f3; }
        .check-option.checked { border-color: #4caf50; background: #e8f5e9; }
        .check-box { width: 24px; height: 24px; border: 2px solid #999; border-radius: 4px; margin-right: 12px; display: flex; align-items: center; justify-content: center; }
        .check-option.checked .check-box { background: #4caf50; border-color: #4caf50; color: white; }
        .dropdown-row { display: flex; align-items: center; gap: 10px; margin: 10px 0; flex-wrap: wrap; }
        .dropdown-row select { padding: 10px 15px; font-size: 1em; border: 2px solid #ddd; border-radius: 8px; background: white; min-width: 180px; }
        .number-input { display: flex; align-items: center; gap: 10px; margin: 10px 0; }
        .number-input input { padding: 12px 15px; font-size: 1.1em; border: 2px solid #ddd; border-radius: 8px; width: 120px; text-align: center; }
        .number-input .unit { font-size: 1.1em; color: #666; }
        .text-input { margin: 10px 0; }
        .text-input input { padding: 12px 15px; font-size: 1em; border: 2px solid #ddd; border-radius: 8px; width: 100%; max-width: 300px; }
        .quiz-nav { display: flex; gap: 10px; justify-content: space-between; }
        .nav-button { padding: 14px 28px; font-size: 1em; font-weight: bold; border: none; border-radius: 10px; cursor: pointer; transition: all 0.2s; }
        .nav-button.prev { background: #e0e0e0; color: #333; }
        .nav-button.next { background: #2196f3; color: white; }
        .nav-button.submit { background: #4caf50; color: white; }
        .nav-button:hover { transform: translateY(-2px); }
        .nav-button:disabled { opacity: 0.5; cursor: not-allowed; transform: none; }
        .feedback-header { background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; padding: 30px; border-radius: 16px; text-align: center; margin-bottom: 20px; }
        .feedback-header .grade { font-size: 3em; font-weight: bold; margin: 10px 0; }
        .feedback-header .points { font-size: 1.3em; opacity: 0.9; }
        .name-input-section { background: white; padding: 20px; border-radius: 12px; margin-bottom: 20px; display: flex; gap: 15px; align-items: center; flex-wrap: wrap; }
        .name-input-section label { font-weight: bold; }
        .name-input-section input { padding: 10px 15px; border: 2px solid #ddd; border-radius: 8px; font-size: 1em; flex: 1; min-width: 200px; }
        .qr-section { background: white; padding: 20px; border-radius: 12px; margin-bottom: 20px; text-align: center; }
        .qr-section h3 { margin-bottom: 15px; }
        #feedbackQR { display: inline-block; padding: 10px; background: white; border-radius: 8px; }
        .submission-code { margin-top: 15px; padding: 10px; background: #f5f5f5; border-radius: 8px; font-family: monospace; font-size: 0.75em; word-break: break-all; max-height: 80px; overflow-y: auto; }
        .copy-btn { margin-top: 10px; padding: 8px 16px; border: 1px solid #ddd; border-radius: 6px; background: white; cursor: pointer; }
        .feedback-question { background: white; border-radius: 12px; margin-bottom: 15px; overflow: hidden; }
        .feedback-question-header { display: flex; justify-content: space-between; align-items: center; padding: 15px 20px; }
        .feedback-question-header.correct { background: #e8f5e9; }
        .feedback-question-header.partial { background: #fff3e0; }
        .feedback-question-header.wrong { background: #ffebee; }
        .feedback-question-body { padding: 20px; }
        .your-answer { margin-top: 10px; padding: 10px; background: #f5f5f5; border-radius: 6px; }
        .correct-answer { margin-top: 10px; padding: 10px; background: #e8f5e9; border-radius: 6px; border-left: 4px solid #4caf50; }
        .print-btn { display: block; width: 100%; padding: 15px; font-size: 1.1em; font-weight: bold; border: none; border-radius: 10px; background: #ff9800; color: white; cursor: pointer; margin-top: 20px; }
        .points-summary { background: white; padding: 20px; border-radius: 12px; margin-bottom: 20px; }
        .points-row { display: flex; justify-content: space-between; padding: 8px 0; border-bottom: 1px solid #eee; }
        .points-row.total { font-weight: bold; border-bottom: none; padding-top: 15px; margin-top: 10px; border-top: 2px solid #333; }
        @media print { body { background: white; } .screen { padding: 0; } .print-btn, .reset-btn, .copy-btn { display: none; } }
        @media (max-width: 600px) { .level-grid { grid-template-columns: repeat(2, 1fr); } .seat-grid { grid-template-columns: repeat(5, 1fr); } }
    </style>
</head>
<body>

<!-- SETUP SCREEN -->
<div id="setupScreen" class="screen active">
    <div class="container">
        <div class="setup-header">
            <h1>üìã Stundenleistung Elektrizit√§tslehre</h1>
            <p>Klasse 8 ‚Äì Stromst√§rke & Spannung</p>
        </div>
        
        <h3 style="margin-bottom: 15px;">‚ö° Niveau w√§hlen:</h3>
        <div class="level-grid">
            <button class="level-btn" data-level="basis">
                <span class="symbol">‚óã</span>
                <span class="name">Basis</span>
                <span class="info">13 Aufgaben ¬∑ 28 P</span>
            </button>
            <button class="level-btn" data-level="stern1">
                <span class="symbol">‚òÖ</span>
                <span class="name">Stern 1</span>
                <span class="info">12 Aufgaben ¬∑ 30 P</span>
            </button>
            <button class="level-btn" data-level="stern2">
                <span class="symbol">‚òÖ‚òÖ</span>
                <span class="name">Stern 2</span>
                <span class="info">9 Aufgaben ¬∑ 30 P</span>
            </button>
            <button class="level-btn" data-level="stern3">
                <span class="symbol">‚òÖ‚òÖ‚òÖ</span>
                <span class="name">Stern 3</span>
                <span class="info">14 Aufgaben ¬∑ 52 P</span>
            </button>
        </div>
        
        <div class="seat-section">
            <h3>üìç Sitzplatz w√§hlen:</h3>
            <div class="seat-grid" id="seatGrid"></div>
        </div>
        
        <button class="start-btn" id="startBtn" disabled>Quiz starten</button>
    </div>
</div>

<!-- QUIZ SCREEN -->
<div id="quizScreen" class="screen">
    <div class="container">
        <div class="quiz-header">
            <div class="quiz-header-top">
                <span class="timer" id="timer">45:00</span>
                <span id="levelBadge">‚óã Basis</span>
                <button class="reset-btn" id="resetBtn">‚ü≥</button>
            </div>
            <div class="progress-bar"><div class="progress-fill" id="progressFill"></div></div>
            <div class="progress-text" id="progressText">Fortschritt: 0/0 Aufgaben</div>
        </div>
        
        <div class="question-nav" id="questionNav"></div>
        <div id="questionContainer"></div>
        
        <div class="quiz-nav">
            <button class="nav-button prev" id="prevBtn">‚Üê Zur√ºck</button>
            <button class="nav-button next" id="nextBtn">Weiter ‚Üí</button>
        </div>
    </div>
</div>

<!-- FEEDBACK SCREEN -->
<div id="feedbackScreen" class="screen">
    <div class="container">
        <div class="feedback-header">
            <div>Stundenleistung Elektrizit√§tslehre ‚Äì Klasse 8</div>
            <div class="grade" id="gradeDisplay">-- NP</div>
            <div class="points" id="pointsDisplay">-- / -- Punkte (---%)</div>
            <div id="timeDisplay" style="margin-top: 10px; opacity: 0.8;"></div>
        </div>
        
        <div class="name-input-section">
            <label>Name:</label>
            <input type="text" id="studentName" placeholder="Dein Name">
            <span id="seatDisplay">Platz: --</span>
            <span id="dateDisplay"></span>
        </div>
        
        <div class="qr-section">
            <h3>üì§ Abgabe-Code (f√ºr Lehrkraft)</h3>
            <div id="feedbackQR"></div>
            <div class="submission-code" id="submissionCodeDisplay"></div>
            <button class="copy-btn" onclick="copyCode()">üìã Code kopieren</button>
        </div>
        
        <div class="points-summary" id="pointsSummary"></div>
        
        <div id="feedbackQuestions"></div>
        
        <button class="print-btn" onclick="window.print()">üñ®Ô∏è Als PDF speichern</button>
    </div>
</div>

<script>
// ============================================================
// KONFIGURATION
// ============================================================
const CONFIG = {
    VERSION: '1.0',
    STORAGE_KEY_PREFIX: 'quiz_v10_elektrik_k8_',
    TEST_DURATION: 45,
    RESET_CODE: '2718',
    LEVELS: {
        'basis': { name: 'Basis', symbol: '‚óã', totalPoints: 28, color: '#9e9e9e' },
        'stern1': { name: 'Stern 1', symbol: '‚òÖ', totalPoints: 30, color: '#ff9800' },
        'stern2': { name: 'Stern 2', symbol: '‚òÖ‚òÖ', totalPoints: 30, color: '#2196f3' },
        'stern3': { name: 'Stern 3', symbol: '‚òÖ‚òÖ‚òÖ', totalPoints: 52, color: '#9c27b0' }
    },
    GRADE_SCALE: [
        { np: 14, pct: 100 }, { np: 13, pct: 96 }, { np: 12, pct: 90.67 },
        { np: 11, pct: 86 }, { np: 10, pct: 80 }, { np: 9, pct: 73.33 },
        { np: 8, pct: 66.67 }, { np: 7, pct: 60 }, { np: 6, pct: 53.33 },
        { np: 5, pct: 46.67 }, { np: 4, pct: 40 }, { np: 3, pct: 33.33 },
        { np: 2, pct: 26.67 }, { np: 1, pct: 20 }, { np: 0, pct: 0 }
    ]
};

// ============================================================
// FRAGEN - BASIS (13 Fragen, 28 Punkte)
// ============================================================
const QUESTIONS_BASIS = [
    {
        id: 'B-F1', type: 'mc', points: 2, afb: 'I',
        text: 'Das <strong>Formelzeichen</strong> f√ºr die elektrische Stromst√§rke ist:',
        options: ['<em>U</em>', '<em>I</em>', '<em>R</em>', '<em>P</em>'],
        correct: 1
    },
    {
        id: 'B-F2', type: 'mc', points: 2, afb: 'I',
        text: 'Die <strong>Einheit</strong> der elektrischen Stromst√§rke hei√üt:',
        options: ['Ampere (A)', 'Volt (V)', 'Watt (W)', 'Ohm (Œ©)'],
        correct: 0
    },
    {
        id: 'B-F3', type: 'mc', points: 2, afb: 'I',
        text: 'Das <strong>Formelzeichen</strong> f√ºr die elektrische Spannung ist:',
        options: ['<em>U</em>', '<em>I</em>', '<em>S</em>', '<em>V</em>'],
        correct: 0
    },
    {
        id: 'B-F4', type: 'mc', points: 2, afb: 'I',
        text: 'Die <strong>Einheit</strong> der elektrischen Spannung hei√üt:',
        options: ['Ampere (A)', 'Volt (V)', 'Watt (W)', 'Ohm (Œ©)'],
        correct: 1
    },
    {
        id: 'B-F5', type: 'dropdown', points: 2, afb: 'I',
        text: 'Vervollst√§ndige: Das Messger√§t f√ºr die Stromst√§rke hei√üt ____.',
        dropdowns: [
            { id: 'd1', label: 'Messger√§t:', options: ['Voltmeter', 'Amperemeter', 'Ohmmeter', 'Wattmeter'], correct: 'Amperemeter' }
        ]
    },
    {
        id: 'B-F6', type: 'dropdown', points: 2, afb: 'I',
        text: 'Vervollst√§ndige die S√§tze zur Schaltung von Messger√§ten:',
        dropdowns: [
            { id: 'd1', label: 'Das Amperemeter wird', options: ['in Reihe', 'parallel'], correct: 'in Reihe' },
            { id: 'd2', label: 'Das Voltmeter wird', options: ['in Reihe', 'parallel'], correct: 'parallel' }
        ]
    },
    {
        id: 'B-F7', type: 'mc', points: 2, afb: 'I',
        text: 'In einer <strong>Reihenschaltung</strong> gilt f√ºr die <strong>Stromst√§rke</strong>:',
        options: ['Die Stromst√§rke ist √ºberall gleich gro√ü', 'Die Teilstr√∂me addieren sich', 'Die Stromst√§rke wird immer kleiner', 'Die Stromst√§rke verdoppelt sich'],
        correct: 0
    },
    {
        id: 'B-F8', type: 'mc', points: 2, afb: 'I',
        text: 'In einer <strong>Reihenschaltung</strong> gilt f√ºr die <strong>Spannung</strong>:',
        options: ['Die Spannung ist √ºberall gleich gro√ü', 'Die Teilspannungen addieren sich zur Gesamtspannung', 'Die Spannung halbiert sich', 'Die Spannung bleibt unver√§ndert'],
        correct: 1
    },
    {
        id: 'B-F9', type: 'mc', points: 2, afb: 'I',
        text: 'In einer <strong>Parallelschaltung</strong> gilt f√ºr die <strong>Spannung</strong>:',
        options: ['Die Spannung ist an allen Zweigen gleich', 'Die Teilspannungen addieren sich', 'Die Spannung teilt sich auf', 'Die Spannung verdoppelt sich'],
        correct: 0
    },
    {
        id: 'B-F10', type: 'number', points: 2, afb: 'II',
        text: 'Zwei Lampen sind <strong>in Reihe</strong> geschaltet. Durch L‚ÇÅ flie√üen 0,4 A. Wie gro√ü ist <em>I</em>‚ÇÇ?',
        svg: `<svg width="340" height="160" viewBox="0 0 340 160">
            <line x1="40" y1="40" x2="90" y2="40" stroke="#000" stroke-width="2"/>
            <line x1="130" y1="40" x2="170" y2="40" stroke="#000" stroke-width="2"/>
            <line x1="210" y1="40" x2="300" y2="40" stroke="#000" stroke-width="2"/>
            <line x1="300" y1="40" x2="300" y2="120" stroke="#000" stroke-width="2"/>
            <line x1="300" y1="120" x2="200" y2="120" stroke="#000" stroke-width="2"/>
            <line x1="200" y1="108" x2="200" y2="132" stroke="#000" stroke-width="2"/>
            <line x1="180" y1="112" x2="180" y2="128" stroke="#000" stroke-width="4"/>
            <text x="206" y="118" font-family="serif" font-size="10">+</text>
            <text x="166" y="118" font-family="serif" font-size="10">‚àí</text>
            <line x1="180" y1="120" x2="40" y2="120" stroke="#000" stroke-width="2"/>
            <line x1="40" y1="120" x2="40" y2="40" stroke="#000" stroke-width="2"/>
            <circle cx="110" cy="40" r="18" fill="white" stroke="#000" stroke-width="2"/>
            <line x1="97" y1="27" x2="123" y2="53" stroke="#000" stroke-width="2"/>
            <line x1="123" y1="27" x2="97" y2="53" stroke="#000" stroke-width="2"/>
            <circle cx="190" cy="40" r="18" fill="white" stroke="#000" stroke-width="2"/>
            <line x1="177" y1="27" x2="203" y2="53" stroke="#000" stroke-width="2"/>
            <line x1="203" y1="27" x2="177" y2="53" stroke="#000" stroke-width="2"/>
            <text x="110" y="80" text-anchor="middle" font-family="serif" font-size="11">L‚ÇÅ</text>
            <text x="190" y="80" text-anchor="middle" font-family="serif" font-size="11">L‚ÇÇ</text>
            <text x="110" y="18" text-anchor="middle" font-family="serif" font-size="10"><tspan font-style="italic">I</tspan>‚ÇÅ = 0,4 A</text>
            <text x="190" y="18" text-anchor="middle" font-family="serif" font-size="10" fill="#c00" font-weight="bold"><tspan font-style="italic">I</tspan>‚ÇÇ = ?</text>
        </svg>`,
        unit: 'A',
        correct: { value: 0.4, tolerance: 0.01 },
        solution: 'Reihenschaltung: Stromst√§rke √ºberall gleich ‚Üí I‚ÇÇ = I‚ÇÅ = 0,4 A'
    },
    {
        id: 'B-F11', type: 'number', points: 2, afb: 'II',
        text: 'Zwei Lampen sind <strong>parallel</strong>. <em>I</em>‚ÇÅ = 0,3 A, <em>I</em>‚ÇÇ = 0,2 A. Berechne <em>I</em><sub>ges</sub>.',
        svg: `<svg width="340" height="200" viewBox="0 0 340 200">
            <line x1="40" y1="40" x2="100" y2="40" stroke="#000" stroke-width="2"/>
            <line x1="100" y1="40" x2="100" y2="140" stroke="#000" stroke-width="2"/>
            <line x1="100" y1="60" x2="140" y2="60" stroke="#000" stroke-width="2"/>
            <line x1="180" y1="60" x2="240" y2="60" stroke="#000" stroke-width="2"/>
            <line x1="100" y1="120" x2="140" y2="120" stroke="#000" stroke-width="2"/>
            <line x1="180" y1="120" x2="240" y2="120" stroke="#000" stroke-width="2"/>
            <line x1="240" y1="60" x2="240" y2="120" stroke="#000" stroke-width="2"/>
            <line x1="240" y1="90" x2="300" y2="90" stroke="#000" stroke-width="2"/>
            <line x1="300" y1="90" x2="300" y2="170" stroke="#000" stroke-width="2"/>
            <line x1="300" y1="170" x2="200" y2="170" stroke="#000" stroke-width="2"/>
            <line x1="200" y1="158" x2="200" y2="182" stroke="#000" stroke-width="2"/>
            <line x1="180" y1="162" x2="180" y2="178" stroke="#000" stroke-width="4"/>
            <text x="206" y="168" font-family="serif" font-size="10">+</text>
            <text x="166" y="168" font-family="serif" font-size="10">‚àí</text>
            <line x1="180" y1="170" x2="40" y2="170" stroke="#000" stroke-width="2"/>
            <line x1="40" y1="170" x2="40" y2="40" stroke="#000" stroke-width="2"/>
            <circle cx="160" cy="60" r="18" fill="white" stroke="#000" stroke-width="2"/>
            <line x1="147" y1="47" x2="173" y2="73" stroke="#000" stroke-width="2"/>
            <line x1="173" y1="47" x2="147" y2="73" stroke="#000" stroke-width="2"/>
            <circle cx="160" cy="120" r="18" fill="white" stroke="#000" stroke-width="2"/>
            <line x1="147" y1="107" x2="173" y2="133" stroke="#000" stroke-width="2"/>
            <line x1="173" y1="107" x2="147" y2="133" stroke="#000" stroke-width="2"/>
            <text x="200" y="55" font-family="serif" font-size="10">L‚ÇÅ: <tspan font-style="italic">I</tspan>‚ÇÅ = 0,3 A</text>
            <text x="200" y="125" font-family="serif" font-size="10">L‚ÇÇ: <tspan font-style="italic">I</tspan>‚ÇÇ = 0,2 A</text>
            <text x="270" y="75" font-family="serif" font-size="10" fill="#c00" font-weight="bold"><tspan font-style="italic">I</tspan><tspan font-size="8" baseline-shift="sub">ges</tspan> = ?</text>
        </svg>`,
        unit: 'A',
        correct: { value: 0.5, tolerance: 0.01 },
        solution: 'Parallelschaltung: I_ges = 0,3 A + 0,2 A = 0,5 A'
    },
    {
        id: 'B-F12', type: 'number', points: 3, afb: 'II',
        text: 'Zwei Lampen in <strong>Reihe</strong> an 12 V. An L‚ÇÅ liegen 5 V. Berechne <em>U</em>‚ÇÇ.',
        svg: `<svg width="340" height="160" viewBox="0 0 340 160">
            <line x1="40" y1="40" x2="90" y2="40" stroke="#000" stroke-width="2"/>
            <line x1="130" y1="40" x2="170" y2="40" stroke="#000" stroke-width="2"/>
            <line x1="210" y1="40" x2="300" y2="40" stroke="#000" stroke-width="2"/>
            <line x1="300" y1="40" x2="300" y2="120" stroke="#000" stroke-width="2"/>
            <line x1="300" y1="120" x2="200" y2="120" stroke="#000" stroke-width="2"/>
            <line x1="200" y1="108" x2="200" y2="132" stroke="#000" stroke-width="2"/>
            <line x1="180" y1="112" x2="180" y2="128" stroke="#000" stroke-width="4"/>
            <text x="190" y="145" font-family="serif" font-size="10">12 V</text>
            <line x1="180" y1="120" x2="40" y2="120" stroke="#000" stroke-width="2"/>
            <line x1="40" y1="120" x2="40" y2="40" stroke="#000" stroke-width="2"/>
            <circle cx="110" cy="40" r="18" fill="white" stroke="#000" stroke-width="2"/>
            <line x1="97" y1="27" x2="123" y2="53" stroke="#000" stroke-width="2"/>
            <line x1="123" y1="27" x2="97" y2="53" stroke="#000" stroke-width="2"/>
            <circle cx="190" cy="40" r="18" fill="white" stroke="#000" stroke-width="2"/>
            <line x1="177" y1="27" x2="203" y2="53" stroke="#000" stroke-width="2"/>
            <line x1="203" y1="27" x2="177" y2="53" stroke="#000" stroke-width="2"/>
            <text x="110" y="80" text-anchor="middle" font-family="serif" font-size="11">L‚ÇÅ</text>
            <text x="190" y="80" text-anchor="middle" font-family="serif" font-size="11">L‚ÇÇ</text>
            <text x="110" y="18" text-anchor="middle" font-family="serif" font-size="10"><tspan font-style="italic">U</tspan>‚ÇÅ = 5 V</text>
            <text x="190" y="18" text-anchor="middle" font-family="serif" font-size="10" fill="#c00" font-weight="bold"><tspan font-style="italic">U</tspan>‚ÇÇ = ?</text>
        </svg>`,
        unit: 'V',
        correct: { value: 7, tolerance: 0.1 },
        solution: 'U‚ÇÇ = U_ges ‚àí U‚ÇÅ = 12 V ‚àí 5 V = 7 V'
    },
    {
        id: 'B-F13', type: 'number', points: 3, afb: 'II',
        text: 'Zwei Lampen sind <strong>parallel</strong> an 9 V angeschlossen. Wie gro√ü ist <em>U</em>‚ÇÅ?',
        svg: `<svg width="340" height="200" viewBox="0 0 340 200">
            <line x1="40" y1="40" x2="100" y2="40" stroke="#000" stroke-width="2"/>
            <line x1="100" y1="40" x2="100" y2="140" stroke="#000" stroke-width="2"/>
            <line x1="100" y1="60" x2="140" y2="60" stroke="#000" stroke-width="2"/>
            <line x1="180" y1="60" x2="240" y2="60" stroke="#000" stroke-width="2"/>
            <line x1="100" y1="120" x2="140" y2="120" stroke="#000" stroke-width="2"/>
            <line x1="180" y1="120" x2="240" y2="120" stroke="#000" stroke-width="2"/>
            <line x1="240" y1="60" x2="240" y2="120" stroke="#000" stroke-width="2"/>
            <line x1="240" y1="90" x2="300" y2="90" stroke="#000" stroke-width="2"/>
            <line x1="300" y1="90" x2="300" y2="170" stroke="#000" stroke-width="2"/>
            <line x1="300" y1="170" x2="200" y2="170" stroke="#000" stroke-width="2"/>
            <line x1="200" y1="158" x2="200" y2="182" stroke="#000" stroke-width="2"/>
            <line x1="180" y1="162" x2="180" y2="178" stroke="#000" stroke-width="4"/>
            <text x="190" y="195" font-family="serif" font-size="10">9 V</text>
            <line x1="180" y1="170" x2="40" y2="170" stroke="#000" stroke-width="2"/>
            <line x1="40" y1="170" x2="40" y2="40" stroke="#000" stroke-width="2"/>
            <circle cx="160" cy="60" r="18" fill="white" stroke="#000" stroke-width="2"/>
            <line x1="147" y1="47" x2="173" y2="73" stroke="#000" stroke-width="2"/>
            <line x1="173" y1="47" x2="147" y2="73" stroke="#000" stroke-width="2"/>
            <circle cx="160" cy="120" r="18" fill="white" stroke="#000" stroke-width="2"/>
            <line x1="147" y1="107" x2="173" y2="133" stroke="#000" stroke-width="2"/>
            <line x1="173" y1="107" x2="147" y2="133" stroke="#000" stroke-width="2"/>
            <text x="200" y="55" font-family="serif" font-size="10" fill="#c00" font-weight="bold">L‚ÇÅ: <tspan font-style="italic">U</tspan>‚ÇÅ = ?</text>
            <text x="200" y="125" font-family="serif" font-size="10" fill="#c00" font-weight="bold">L‚ÇÇ: <tspan font-style="italic">U</tspan>‚ÇÇ = ?</text>
        </svg>`,
        unit: 'V',
        correct: { value: 9, tolerance: 0.1 },
        solution: 'Parallelschaltung: U‚ÇÅ = U‚ÇÇ = U_ges = 9 V'
    }
];

// ============================================================
// FRAGEN - STERN1 (12 Fragen, 30 Punkte)
// ============================================================
const QUESTIONS_STERN1 = [
    {
        id: 'S1-F1', type: 'dropdown', points: 2, afb: 'I',
        text: 'Vervollst√§ndige die S√§tze:',
        dropdowns: [
            { id: 'd1', label: 'Das Formelzeichen der Stromst√§rke ist', options: ['U', 'I', 'R', 'P'], correct: 'I' },
            { id: 'd2', label: 'Die Einheit der Stromst√§rke hei√üt', options: ['Volt', 'Ampere', 'Watt', 'Ohm'], correct: 'Ampere' }
        ]
    },
    {
        id: 'S1-F2', type: 'dropdown', points: 2, afb: 'I',
        text: 'Die Stromst√§rke gibt an, wie viel ____ pro ____ durch einen Leiter flie√üt.',
        dropdowns: [
            { id: 'd1', label: 'wie viel', options: ['Energie', 'Ladung', 'Spannung', 'Widerstand'], correct: 'Ladung' },
            { id: 'd2', label: 'pro', options: ['Strecke', 'Zeit', 'Fl√§che', 'Volumen'], correct: 'Zeit' }
        ]
    },
    {
        id: 'S1-F3', type: 'dropdown', points: 2, afb: 'I',
        text: 'Vervollst√§ndige die S√§tze:',
        dropdowns: [
            { id: 'd1', label: 'Das Formelzeichen der Spannung ist', options: ['U', 'I', 'S', 'V'], correct: 'U' },
            { id: 'd2', label: 'Die Einheit der Spannung hei√üt', options: ['Ampere', 'Volt', 'Watt', 'Ohm'], correct: 'Volt' }
        ]
    },
    {
        id: 'S1-F4', type: 'multicheck', points: 2, afb: 'I',
        text: 'Welche Aussagen gelten f√ºr die <strong>Reihenschaltung</strong>? (Mehrfachauswahl)',
        options: [
            { text: 'Die Stromst√§rke ist √ºberall gleich gro√ü', correct: true },
            { text: 'Die Teilspannungen addieren sich zur Gesamtspannung', correct: true },
            { text: 'Die Teilstr√∂me addieren sich zum Gesamtstrom', correct: false },
            { text: 'An allen Stellen liegt dieselbe Spannung', correct: false }
        ]
    },
    {
        id: 'S1-F5', type: 'multicheck', points: 2, afb: 'I',
        text: 'Welche Aussagen gelten f√ºr die <strong>Parallelschaltung</strong>? (Mehrfachauswahl)',
        options: [
            { text: 'Die Stromst√§rke ist √ºberall gleich gro√ü', correct: false },
            { text: 'Die Teilstr√∂me addieren sich zum Gesamtstrom', correct: true },
            { text: 'An allen Zweigen liegt dieselbe Spannung', correct: true },
            { text: 'Die Teilspannungen addieren sich', correct: false }
        ]
    },
    {
        id: 'S1-F6', type: 'dropdown', points: 2, afb: 'I',
        text: 'Ordne die Messger√§te der richtigen Schaltungsart zu:',
        dropdowns: [
            { id: 'd1', label: 'Das Amperemeter wird geschaltet:', options: ['in Reihe', 'parallel'], correct: 'in Reihe' },
            { id: 'd2', label: 'Das Voltmeter wird geschaltet:', options: ['in Reihe', 'parallel'], correct: 'parallel' }
        ]
    },
    {
        id: 'S1-F7', type: 'number', points: 3, afb: 'II',
        text: 'Drei Lampen sind <strong>in Reihe</strong> geschaltet. Durch L‚ÇÅ flie√üen 0,5 A. Bestimme <em>I</em>‚ÇÇ.',
        svg: `<svg width="400" height="160" viewBox="0 0 400 160">
            <line x1="40" y1="40" x2="80" y2="40" stroke="#000" stroke-width="2"/>
            <line x1="120" y1="40" x2="160" y2="40" stroke="#000" stroke-width="2"/>
            <line x1="200" y1="40" x2="240" y2="40" stroke="#000" stroke-width="2"/>
            <line x1="280" y1="40" x2="360" y2="40" stroke="#000" stroke-width="2"/>
            <line x1="360" y1="40" x2="360" y2="120" stroke="#000" stroke-width="2"/>
            <line x1="360" y1="120" x2="240" y2="120" stroke="#000" stroke-width="2"/>
            <line x1="240" y1="108" x2="240" y2="132" stroke="#000" stroke-width="2"/>
            <line x1="220" y1="112" x2="220" y2="128" stroke="#000" stroke-width="4"/>
            <line x1="220" y1="120" x2="40" y2="120" stroke="#000" stroke-width="2"/>
            <line x1="40" y1="120" x2="40" y2="40" stroke="#000" stroke-width="2"/>
            <circle cx="100" cy="40" r="18" fill="white" stroke="#000" stroke-width="2"/>
            <line x1="87" y1="27" x2="113" y2="53" stroke="#000" stroke-width="2"/>
            <line x1="113" y1="27" x2="87" y2="53" stroke="#000" stroke-width="2"/>
            <circle cx="180" cy="40" r="18" fill="white" stroke="#000" stroke-width="2"/>
            <line x1="167" y1="27" x2="193" y2="53" stroke="#000" stroke-width="2"/>
            <line x1="193" y1="27" x2="167" y2="53" stroke="#000" stroke-width="2"/>
            <circle cx="260" cy="40" r="18" fill="white" stroke="#000" stroke-width="2"/>
            <line x1="247" y1="27" x2="273" y2="53" stroke="#000" stroke-width="2"/>
            <line x1="273" y1="27" x2="247" y2="53" stroke="#000" stroke-width="2"/>
            <text x="100" y="80" text-anchor="middle" font-family="serif" font-size="10">L‚ÇÅ</text>
            <text x="180" y="80" text-anchor="middle" font-family="serif" font-size="10">L‚ÇÇ</text>
            <text x="260" y="80" text-anchor="middle" font-family="serif" font-size="10">L‚ÇÉ</text>
            <text x="100" y="18" text-anchor="middle" font-family="serif" font-size="9"><tspan font-style="italic">I</tspan>‚ÇÅ = 0,5 A</text>
            <text x="180" y="18" text-anchor="middle" font-family="serif" font-size="9" fill="#c00" font-weight="bold"><tspan font-style="italic">I</tspan>‚ÇÇ = ?</text>
            <text x="260" y="18" text-anchor="middle" font-family="serif" font-size="9" fill="#c00" font-weight="bold"><tspan font-style="italic">I</tspan>‚ÇÉ = ?</text>
        </svg>`,
        unit: 'A',
        correct: { value: 0.5, tolerance: 0.01 },
        solution: 'Reihenschaltung: I‚ÇÇ = I‚ÇÉ = I‚ÇÅ = 0,5 A'
    },
    {
        id: 'S1-F8', type: 'number', points: 3, afb: 'II',
        text: 'Drei Lampen <strong>parallel</strong>: <em>I</em>‚ÇÅ = 0,3 A, <em>I</em>‚ÇÇ = 0,4 A, <em>I</em>‚ÇÉ = 0,3 A. Berechne <em>I</em><sub>ges</sub>.',
        svg: `<svg width="360" height="240" viewBox="0 0 360 240">
            <line x1="40" y1="30" x2="100" y2="30" stroke="#000" stroke-width="2"/>
            <line x1="100" y1="30" x2="100" y2="180" stroke="#000" stroke-width="2"/>
            <line x1="100" y1="50" x2="140" y2="50" stroke="#000" stroke-width="2"/>
            <line x1="180" y1="50" x2="240" y2="50" stroke="#000" stroke-width="2"/>
            <line x1="100" y1="105" x2="140" y2="105" stroke="#000" stroke-width="2"/>
            <line x1="180" y1="105" x2="240" y2="105" stroke="#000" stroke-width="2"/>
            <line x1="100" y1="160" x2="140" y2="160" stroke="#000" stroke-width="2"/>
            <line x1="180" y1="160" x2="240" y2="160" stroke="#000" stroke-width="2"/>
            <line x1="240" y1="50" x2="240" y2="160" stroke="#000" stroke-width="2"/>
            <line x1="240" y1="105" x2="320" y2="105" stroke="#000" stroke-width="2"/>
            <line x1="320" y1="105" x2="320" y2="210" stroke="#000" stroke-width="2"/>
            <line x1="320" y1="210" x2="200" y2="210" stroke="#000" stroke-width="2"/>
            <line x1="200" y1="198" x2="200" y2="222" stroke="#000" stroke-width="2"/>
            <line x1="180" y1="202" x2="180" y2="218" stroke="#000" stroke-width="4"/>
            <line x1="180" y1="210" x2="40" y2="210" stroke="#000" stroke-width="2"/>
            <line x1="40" y1="210" x2="40" y2="30" stroke="#000" stroke-width="2"/>
            <circle cx="160" cy="50" r="18" fill="white" stroke="#000" stroke-width="2"/>
            <line x1="147" y1="37" x2="173" y2="63" stroke="#000" stroke-width="2"/>
            <line x1="173" y1="37" x2="147" y2="63" stroke="#000" stroke-width="2"/>
            <circle cx="160" cy="105" r="18" fill="white" stroke="#000" stroke-width="2"/>
            <line x1="147" y1="92" x2="173" y2="118" stroke="#000" stroke-width="2"/>
            <line x1="173" y1="92" x2="147" y2="118" stroke="#000" stroke-width="2"/>
            <circle cx="160" cy="160" r="18" fill="white" stroke="#000" stroke-width="2"/>
            <line x1="147" y1="147" x2="173" y2="173" stroke="#000" stroke-width="2"/>
            <line x1="173" y1="147" x2="147" y2="173" stroke="#000" stroke-width="2"/>
            <text x="200" y="45" font-family="serif" font-size="9">L‚ÇÅ: <tspan font-style="italic">I</tspan>‚ÇÅ = 0,3 A</text>
            <text x="200" y="110" font-family="serif" font-size="9">L‚ÇÇ: <tspan font-style="italic">I</tspan>‚ÇÇ = 0,4 A</text>
            <text x="200" y="165" font-family="serif" font-size="9">L‚ÇÉ: <tspan font-style="italic">I</tspan>‚ÇÉ = 0,3 A</text>
            <text x="280" y="90" font-family="serif" font-size="9" fill="#c00" font-weight="bold"><tspan font-style="italic">I</tspan><tspan font-size="7" baseline-shift="sub">ges</tspan> = ?</text>
        </svg>`,
        unit: 'A',
        correct: { value: 1, tolerance: 0.01 },
        solution: 'I_ges = 0,3 A + 0,4 A + 0,3 A = 1 A'
    },
    {
        id: 'S1-F9', type: 'number', points: 3, afb: 'II',
        text: 'Zwei Zweige parallel: <em>I</em>‚ÇÅ = 400 mA, <em>I</em>‚ÇÇ = 600 mA. Berechne <em>I</em><sub>ges</sub> in <strong>Ampere</strong>.',
        unit: 'A',
        correct: { value: 1, tolerance: 0.01 },
        solution: '400 mA = 0,4 A; 600 mA = 0,6 A ‚Üí I_ges = 1 A'
    },
    {
        id: 'S1-F10', type: 'number', points: 3, afb: 'II',
        text: 'Drei Lampen <strong>in Reihe</strong> an 12 V: <em>U</em>‚ÇÅ = 3 V, <em>U</em>‚ÇÇ = 5 V. Berechne <em>U</em>‚ÇÉ.',
        svg: `<svg width="400" height="160" viewBox="0 0 400 160">
            <line x1="40" y1="40" x2="80" y2="40" stroke="#000" stroke-width="2"/>
            <line x1="120" y1="40" x2="160" y2="40" stroke="#000" stroke-width="2"/>
            <line x1="200" y1="40" x2="240" y2="40" stroke="#000" stroke-width="2"/>
            <line x1="280" y1="40" x2="360" y2="40" stroke="#000" stroke-width="2"/>
            <line x1="360" y1="40" x2="360" y2="120" stroke="#000" stroke-width="2"/>
            <line x1="360" y1="120" x2="240" y2="120" stroke="#000" stroke-width="2"/>
            <line x1="240" y1="108" x2="240" y2="132" stroke="#000" stroke-width="2"/>
            <line x1="220" y1="112" x2="220" y2="128" stroke="#000" stroke-width="4"/>
            <text x="230" y="145" font-family="serif" font-size="9">12 V</text>
            <line x1="220" y1="120" x2="40" y2="120" stroke="#000" stroke-width="2"/>
            <line x1="40" y1="120" x2="40" y2="40" stroke="#000" stroke-width="2"/>
            <circle cx="100" cy="40" r="18" fill="white" stroke="#000" stroke-width="2"/>
            <line x1="87" y1="27" x2="113" y2="53" stroke="#000" stroke-width="2"/>
            <line x1="113" y1="27" x2="87" y2="53" stroke="#000" stroke-width="2"/>
            <circle cx="180" cy="40" r="18" fill="white" stroke="#000" stroke-width="2"/>
            <line x1="167" y1="27" x2="193" y2="53" stroke="#000" stroke-width="2"/>
            <line x1="193" y1="27" x2="167" y2="53" stroke="#000" stroke-width="2"/>
            <circle cx="260" cy="40" r="18" fill="white" stroke="#000" stroke-width="2"/>
            <line x1="247" y1="27" x2="273" y2="53" stroke="#000" stroke-width="2"/>
            <line x1="273" y1="27" x2="247" y2="53" stroke="#000" stroke-width="2"/>
            <text x="100" y="80" text-anchor="middle" font-family="serif" font-size="10">L‚ÇÅ</text>
            <text x="180" y="80" text-anchor="middle" font-family="serif" font-size="10">L‚ÇÇ</text>
            <text x="260" y="80" text-anchor="middle" font-family="serif" font-size="10">L‚ÇÉ</text>
            <text x="100" y="18" text-anchor="middle" font-family="serif" font-size="9"><tspan font-style="italic">U</tspan>‚ÇÅ = 3 V</text>
            <text x="180" y="18" text-anchor="middle" font-family="serif" font-size="9"><tspan font-style="italic">U</tspan>‚ÇÇ = 5 V</text>
            <text x="260" y="18" text-anchor="middle" font-family="serif" font-size="9" fill="#c00" font-weight="bold"><tspan font-style="italic">U</tspan>‚ÇÉ = ?</text>
        </svg>`,
        unit: 'V',
        correct: { value: 4, tolerance: 0.1 },
        solution: 'U‚ÇÉ = 12 V ‚àí 3 V ‚àí 5 V = 4 V'
    },
    {
        id: 'S1-F11', type: 'number', points: 3, afb: 'II',
        text: 'Drei Lampen sind <strong>parallel</strong> an eine 9-V-Batterie angeschlossen. Wie gro√ü ist die Spannung an jeder Lampe?',
        svg: `<svg width="360" height="240" viewBox="0 0 360 240">
            <line x1="40" y1="30" x2="100" y2="30" stroke="#000" stroke-width="2"/>
            <line x1="100" y1="30" x2="100" y2="180" stroke="#000" stroke-width="2"/>
            <line x1="100" y1="50" x2="140" y2="50" stroke="#000" stroke-width="2"/>
            <line x1="180" y1="50" x2="240" y2="50" stroke="#000" stroke-width="2"/>
            <line x1="100" y1="105" x2="140" y2="105" stroke="#000" stroke-width="2"/>
            <line x1="180" y1="105" x2="240" y2="105" stroke="#000" stroke-width="2"/>
            <line x1="100" y1="160" x2="140" y2="160" stroke="#000" stroke-width="2"/>
            <line x1="180" y1="160" x2="240" y2="160" stroke="#000" stroke-width="2"/>
            <line x1="240" y1="50" x2="240" y2="160" stroke="#000" stroke-width="2"/>
            <line x1="240" y1="105" x2="320" y2="105" stroke="#000" stroke-width="2"/>
            <line x1="320" y1="105" x2="320" y2="210" stroke="#000" stroke-width="2"/>
            <line x1="320" y1="210" x2="200" y2="210" stroke="#000" stroke-width="2"/>
            <line x1="200" y1="198" x2="200" y2="222" stroke="#000" stroke-width="2"/>
            <line x1="180" y1="202" x2="180" y2="218" stroke="#000" stroke-width="4"/>
            <text x="190" y="232" font-family="serif" font-size="9">9 V</text>
            <line x1="180" y1="210" x2="40" y2="210" stroke="#000" stroke-width="2"/>
            <line x1="40" y1="210" x2="40" y2="30" stroke="#000" stroke-width="2"/>
            <circle cx="160" cy="50" r="18" fill="white" stroke="#000" stroke-width="2"/>
            <line x1="147" y1="37" x2="173" y2="63" stroke="#000" stroke-width="2"/>
            <line x1="173" y1="37" x2="147" y2="63" stroke="#000" stroke-width="2"/>
            <circle cx="160" cy="105" r="18" fill="white" stroke="#000" stroke-width="2"/>
            <line x1="147" y1="92" x2="173" y2="118" stroke="#000" stroke-width="2"/>
            <line x1="173" y1="92" x2="147" y2="118" stroke="#000" stroke-width="2"/>
            <circle cx="160" cy="160" r="18" fill="white" stroke="#000" stroke-width="2"/>
            <line x1="147" y1="147" x2="173" y2="173" stroke="#000" stroke-width="2"/>
            <line x1="173" y1="147" x2="147" y2="173" stroke="#000" stroke-width="2"/>
            <text x="200" y="45" font-family="serif" font-size="9" fill="#c00" font-weight="bold">L‚ÇÅ: <tspan font-style="italic">U</tspan>‚ÇÅ = ?</text>
            <text x="200" y="110" font-family="serif" font-size="9" fill="#c00" font-weight="bold">L‚ÇÇ: <tspan font-style="italic">U</tspan>‚ÇÇ = ?</text>
            <text x="200" y="165" font-family="serif" font-size="9" fill="#c00" font-weight="bold">L‚ÇÉ: <tspan font-style="italic">U</tspan>‚ÇÉ = ?</text>
        </svg>`,
        unit: 'V',
        correct: { value: 9, tolerance: 0.1 },
        solution: 'Parallelschaltung: U‚ÇÅ = U‚ÇÇ = U‚ÇÉ = 9 V'
    },
    {
        id: 'S1-F12', type: 'number', points: 3, afb: 'II',
        text: 'Gemischte Schaltung: L‚ÇÅ und L‚ÇÇ in Reihe, L‚ÇÉ parallel dazu. Gesamtspannung 12 V. <em>U</em>‚ÇÅ = 4 V, <em>U</em>‚ÇÇ = 8 V. Berechne <em>U</em>‚ÇÉ.',
        svg: `<svg width="360" height="200" viewBox="0 0 360 200">
            <line x1="40" y1="30" x2="100" y2="30" stroke="#000" stroke-width="2"/>
            <line x1="100" y1="30" x2="100" y2="130" stroke="#000" stroke-width="2"/>
            <line x1="100" y1="50" x2="130" y2="50" stroke="#000" stroke-width="2"/>
            <line x1="170" y1="50" x2="200" y2="50" stroke="#000" stroke-width="2"/>
            <line x1="240" y1="50" x2="280" y2="50" stroke="#000" stroke-width="2"/>
            <line x1="100" y1="110" x2="160" y2="110" stroke="#000" stroke-width="2"/>
            <line x1="200" y1="110" x2="280" y2="110" stroke="#000" stroke-width="2"/>
            <line x1="280" y1="50" x2="280" y2="110" stroke="#000" stroke-width="2"/>
            <line x1="280" y1="80" x2="320" y2="80" stroke="#000" stroke-width="2"/>
            <line x1="320" y1="80" x2="320" y2="170" stroke="#000" stroke-width="2"/>
            <line x1="320" y1="170" x2="200" y2="170" stroke="#000" stroke-width="2"/>
            <line x1="200" y1="158" x2="200" y2="182" stroke="#000" stroke-width="2"/>
            <line x1="180" y1="162" x2="180" y2="178" stroke="#000" stroke-width="4"/>
            <text x="190" y="195" font-family="serif" font-size="9">12 V</text>
            <line x1="180" y1="170" x2="40" y2="170" stroke="#000" stroke-width="2"/>
            <line x1="40" y1="170" x2="40" y2="30" stroke="#000" stroke-width="2"/>
            <circle cx="150" cy="50" r="18" fill="white" stroke="#000" stroke-width="2"/>
            <line x1="137" y1="37" x2="163" y2="63" stroke="#000" stroke-width="2"/>
            <line x1="163" y1="37" x2="137" y2="63" stroke="#000" stroke-width="2"/>
            <circle cx="220" cy="50" r="18" fill="white" stroke="#000" stroke-width="2"/>
            <line x1="207" y1="37" x2="233" y2="63" stroke="#000" stroke-width="2"/>
            <line x1="233" y1="37" x2="207" y2="63" stroke="#000" stroke-width="2"/>
            <circle cx="180" cy="110" r="18" fill="white" stroke="#000" stroke-width="2"/>
            <line x1="167" y1="97" x2="193" y2="123" stroke="#000" stroke-width="2"/>
            <line x1="193" y1="97" x2="167" y2="123" stroke="#000" stroke-width="2"/>
            <text x="150" y="25" text-anchor="middle" font-family="serif" font-size="9">L‚ÇÅ: <tspan font-style="italic">U</tspan>‚ÇÅ = 4 V</text>
            <text x="220" y="25" text-anchor="middle" font-family="serif" font-size="9">L‚ÇÇ: <tspan font-style="italic">U</tspan>‚ÇÇ = 8 V</text>
            <text x="240" y="115" font-family="serif" font-size="9" fill="#c00" font-weight="bold">L‚ÇÉ: <tspan font-style="italic">U</tspan>‚ÇÉ = ?</text>
        </svg>`,
        unit: 'V',
        correct: { value: 12, tolerance: 0.1 },
        solution: 'L‚ÇÉ ist parallel zum gesamten Reihenzweig ‚Üí U‚ÇÉ = U_ges = 12 V'
    }
];

// ============================================================
// FRAGEN - STERN2 (9 Fragen, 30 Punkte)
// ============================================================
const QUESTIONS_STERN2 = [
    {
        id: 'S2-F1', type: 'text', points: 3, afb: 'I',
        text: 'Gib an:<br>‚Ä¢ Formelzeichen der Stromst√§rke<br>‚Ä¢ Einheit der Stromst√§rke<br>‚Ä¢ Messger√§t f√ºr Stromst√§rke',
        fields: [
            { id: 'f1', label: 'Formelzeichen:', correct: ['I'], points: 1 },
            { id: 'f2', label: 'Einheit:', correct: ['Ampere', 'A'], points: 1 },
            { id: 'f3', label: 'Messger√§t:', correct: ['Amperemeter', 'Strommesser', 'Stromst√§rkemessger√§t'], points: 1 }
        ]
    },
    {
        id: 'S2-F2', type: 'text', points: 3, afb: 'I',
        text: 'Gib an:<br>‚Ä¢ Formelzeichen der Spannung<br>‚Ä¢ Einheit der Spannung<br>‚Ä¢ Messger√§t f√ºr Spannung',
        fields: [
            { id: 'f1', label: 'Formelzeichen:', correct: ['U'], points: 1 },
            { id: 'f2', label: 'Einheit:', correct: ['Volt', 'V'], points: 1 },
            { id: 'f3', label: 'Messger√§t:', correct: ['Voltmeter', 'Spannungsmesser', 'Spannungsmessger√§t'], points: 1 }
        ]
    },
    {
        id: 'S2-F3', type: 'dropdown', points: 4, afb: 'I',
        text: 'Ordne die Regeln der richtigen Schaltungsart zu:',
        dropdowns: [
            { id: 'd1', label: 'Die Stromst√§rke ist √ºberall gleich:', options: ['Reihenschaltung', 'Parallelschaltung'], correct: 'Reihenschaltung' },
            { id: 'd2', label: 'Die Teilstr√∂me addieren sich:', options: ['Reihenschaltung', 'Parallelschaltung'], correct: 'Parallelschaltung' },
            { id: 'd3', label: 'Die Teilspannungen addieren sich:', options: ['Reihenschaltung', 'Parallelschaltung'], correct: 'Reihenschaltung' },
            { id: 'd4', label: 'Spannung ist an allen Zweigen gleich:', options: ['Reihenschaltung', 'Parallelschaltung'], correct: 'Parallelschaltung' }
        ]
    },
    {
        id: 'S2-F4', type: 'dropdown', points: 2, afb: 'I',
        text: 'Wie werden die Messger√§te geschaltet?',
        dropdowns: [
            { id: 'd1', label: 'Amperemeter:', options: ['in Reihe', 'parallel'], correct: 'in Reihe' },
            { id: 'd2', label: 'Voltmeter:', options: ['in Reihe', 'parallel'], correct: 'parallel' }
        ]
    },
    {
        id: 'S2-F5', type: 'number', points: 4, afb: 'II',
        text: 'Gemischte Schaltung: L‚ÇÅ in Reihe mit (L‚ÇÇ || L‚ÇÉ). <em>I</em><sub>ges</sub> = 1 A, <em>I</em>‚ÇÇ = 0,6 A. Berechne <em>I</em>‚ÇÅ und <em>I</em>‚ÇÉ.',
        svg: `<svg width="380" height="200" viewBox="0 0 380 200">
            <line x1="40" y1="40" x2="80" y2="40" stroke="#000" stroke-width="2"/>
            <line x1="120" y1="40" x2="160" y2="40" stroke="#000" stroke-width="2"/>
            <line x1="160" y1="40" x2="160" y2="120" stroke="#000" stroke-width="2"/>
            <line x1="160" y1="55" x2="200" y2="55" stroke="#000" stroke-width="2"/>
            <line x1="240" y1="55" x2="300" y2="55" stroke="#000" stroke-width="2"/>
            <line x1="160" y1="105" x2="200" y2="105" stroke="#000" stroke-width="2"/>
            <line x1="240" y1="105" x2="300" y2="105" stroke="#000" stroke-width="2"/>
            <line x1="300" y1="55" x2="300" y2="105" stroke="#000" stroke-width="2"/>
            <line x1="300" y1="80" x2="340" y2="80" stroke="#000" stroke-width="2"/>
            <line x1="340" y1="80" x2="340" y2="170" stroke="#000" stroke-width="2"/>
            <line x1="340" y1="170" x2="220" y2="170" stroke="#000" stroke-width="2"/>
            <line x1="220" y1="158" x2="220" y2="182" stroke="#000" stroke-width="2"/>
            <line x1="200" y1="162" x2="200" y2="178" stroke="#000" stroke-width="4"/>
            <line x1="200" y1="170" x2="40" y2="170" stroke="#000" stroke-width="2"/>
            <line x1="40" y1="170" x2="40" y2="40" stroke="#000" stroke-width="2"/>
            <circle cx="100" cy="40" r="18" fill="white" stroke="#000" stroke-width="2"/>
            <line x1="87" y1="27" x2="113" y2="53" stroke="#000" stroke-width="2"/>
            <line x1="113" y1="27" x2="87" y2="53" stroke="#000" stroke-width="2"/>
            <circle cx="220" cy="55" r="18" fill="white" stroke="#000" stroke-width="2"/>
            <line x1="207" y1="42" x2="233" y2="68" stroke="#000" stroke-width="2"/>
            <line x1="233" y1="42" x2="207" y2="68" stroke="#000" stroke-width="2"/>
            <circle cx="220" cy="105" r="18" fill="white" stroke="#000" stroke-width="2"/>
            <line x1="207" y1="92" x2="233" y2="118" stroke="#000" stroke-width="2"/>
            <line x1="233" y1="92" x2="207" y2="118" stroke="#000" stroke-width="2"/>
            <text x="100" y="75" text-anchor="middle" font-family="serif" font-size="9">L‚ÇÅ</text>
            <text x="255" y="50" font-family="serif" font-size="9">L‚ÇÇ: <tspan font-style="italic">I</tspan>‚ÇÇ = 0,6 A</text>
            <text x="255" y="110" font-family="serif" font-size="9" fill="#c00" font-weight="bold">L‚ÇÉ: <tspan font-style="italic">I</tspan>‚ÇÉ = ?</text>
            <text x="65" y="25" font-family="serif" font-size="9"><tspan font-style="italic">I</tspan><tspan font-size="7" baseline-shift="sub">ges</tspan> = 1 A</text>
            <text x="100" y="18" text-anchor="middle" font-family="serif" font-size="9" fill="#c00" font-weight="bold"><tspan font-style="italic">I</tspan>‚ÇÅ = ?</text>
        </svg>`,
        unit: 'A',
        multiAnswer: true,
        answers: [
            { label: 'I‚ÇÅ', correct: { value: 1, tolerance: 0.01 } },
            { label: 'I‚ÇÉ', correct: { value: 0.4, tolerance: 0.01 } }
        ],
        solution: 'I‚ÇÅ = I_ges = 1 A (Reihe); I‚ÇÉ = 1 A ‚àí 0,6 A = 0,4 A (Parallel)'
    },
    {
        id: 'S2-F6', type: 'number', points: 3, afb: 'II',
        text: 'Vier Motoren parallel: <em>I</em><sub>ges</sub> = 2,4 A. <em>I</em>‚ÇÅ = 0,8 A, <em>I</em>‚ÇÇ = 0,5 A, <em>I</em>‚ÇÉ = 0,6 A. Berechne <em>I</em>‚ÇÑ.',
        svg: `<svg width="360" height="260" viewBox="0 0 360 260">
            <line x1="40" y1="25" x2="100" y2="25" stroke="#000" stroke-width="2"/>
            <line x1="100" y1="25" x2="100" y2="195" stroke="#000" stroke-width="2"/>
            <line x1="100" y1="40" x2="140" y2="40" stroke="#000" stroke-width="2"/>
            <line x1="180" y1="40" x2="240" y2="40" stroke="#000" stroke-width="2"/>
            <line x1="100" y1="85" x2="140" y2="85" stroke="#000" stroke-width="2"/>
            <line x1="180" y1="85" x2="240" y2="85" stroke="#000" stroke-width="2"/>
            <line x1="100" y1="130" x2="140" y2="130" stroke="#000" stroke-width="2"/>
            <line x1="180" y1="130" x2="240" y2="130" stroke="#000" stroke-width="2"/>
            <line x1="100" y1="175" x2="140" y2="175" stroke="#000" stroke-width="2"/>
            <line x1="180" y1="175" x2="240" y2="175" stroke="#000" stroke-width="2"/>
            <line x1="240" y1="40" x2="240" y2="175" stroke="#000" stroke-width="2"/>
            <line x1="240" y1="107" x2="320" y2="107" stroke="#000" stroke-width="2"/>
            <line x1="320" y1="107" x2="320" y2="230" stroke="#000" stroke-width="2"/>
            <line x1="320" y1="230" x2="200" y2="230" stroke="#000" stroke-width="2"/>
            <line x1="200" y1="218" x2="200" y2="242" stroke="#000" stroke-width="2"/>
            <line x1="180" y1="222" x2="180" y2="238" stroke="#000" stroke-width="4"/>
            <line x1="180" y1="230" x2="40" y2="230" stroke="#000" stroke-width="2"/>
            <line x1="40" y1="230" x2="40" y2="25" stroke="#000" stroke-width="2"/>
            <circle cx="160" cy="40" r="18" fill="white" stroke="#000" stroke-width="2"/>
            <text x="160" y="45" text-anchor="middle" font-family="serif" font-size="10" font-weight="bold">M</text>
            <circle cx="160" cy="85" r="18" fill="white" stroke="#000" stroke-width="2"/>
            <text x="160" y="90" text-anchor="middle" font-family="serif" font-size="10" font-weight="bold">M</text>
            <circle cx="160" cy="130" r="18" fill="white" stroke="#000" stroke-width="2"/>
            <text x="160" y="135" text-anchor="middle" font-family="serif" font-size="10" font-weight="bold">M</text>
            <circle cx="160" cy="175" r="18" fill="white" stroke="#000" stroke-width="2"/>
            <text x="160" y="180" text-anchor="middle" font-family="serif" font-size="10" font-weight="bold">M</text>
            <text x="200" y="35" font-family="serif" font-size="8">M‚ÇÅ: <tspan font-style="italic">I</tspan>‚ÇÅ = 0,8 A</text>
            <text x="200" y="90" font-family="serif" font-size="8">M‚ÇÇ: <tspan font-style="italic">I</tspan>‚ÇÇ = 0,5 A</text>
            <text x="200" y="135" font-family="serif" font-size="8">M‚ÇÉ: <tspan font-style="italic">I</tspan>‚ÇÉ = 0,6 A</text>
            <text x="200" y="180" font-family="serif" font-size="8" fill="#c00" font-weight="bold">M‚ÇÑ: <tspan font-style="italic">I</tspan>‚ÇÑ = ?</text>
            <text x="280" y="95" font-family="serif" font-size="8"><tspan font-style="italic">I</tspan><tspan font-size="6" baseline-shift="sub">ges</tspan> = 2,4 A</text>
        </svg>`,
        unit: 'A',
        correct: { value: 0.5, tolerance: 0.01 },
        solution: 'I‚ÇÑ = 2,4 A ‚àí 0,8 A ‚àí 0,5 A ‚àí 0,6 A = 0,5 A'
    },
    {
        id: 'S2-F7', type: 'number', points: 2, afb: 'II',
        text: 'Drei Zweige parallel: <em>I</em>‚ÇÅ = 250 mA, <em>I</em>‚ÇÇ = 0,35 A, <em>I</em>‚ÇÉ = 400 mA. Berechne <em>I</em><sub>ges</sub> in <strong>Ampere</strong>.',
        unit: 'A',
        correct: { value: 1, tolerance: 0.01 },
        solution: '250 mA = 0,25 A; 400 mA = 0,4 A ‚Üí I_ges = 0,25 + 0,35 + 0,4 = 1 A'
    },
    {
        id: 'S2-F8', type: 'number', points: 4, afb: 'II',
        text: 'Drei Lampen <strong>in Reihe</strong> an 18 V: <em>U</em>‚ÇÅ = 4 V, <em>U</em>‚ÇÇ = 6 V. Berechne <em>U</em>‚ÇÉ.',
        svg: `<svg width="400" height="160" viewBox="0 0 400 160">
            <line x1="40" y1="40" x2="80" y2="40" stroke="#000" stroke-width="2"/>
            <line x1="120" y1="40" x2="160" y2="40" stroke="#000" stroke-width="2"/>
            <line x1="200" y1="40" x2="240" y2="40" stroke="#000" stroke-width="2"/>
            <line x1="280" y1="40" x2="360" y2="40" stroke="#000" stroke-width="2"/>
            <line x1="360" y1="40" x2="360" y2="120" stroke="#000" stroke-width="2"/>
            <line x1="360" y1="120" x2="240" y2="120" stroke="#000" stroke-width="2"/>
            <line x1="240" y1="108" x2="240" y2="132" stroke="#000" stroke-width="2"/>
            <line x1="220" y1="112" x2="220" y2="128" stroke="#000" stroke-width="4"/>
            <text x="230" y="145" font-family="serif" font-size="9">18 V</text>
            <line x1="220" y1="120" x2="40" y2="120" stroke="#000" stroke-width="2"/>
            <line x1="40" y1="120" x2="40" y2="40" stroke="#000" stroke-width="2"/>
            <circle cx="100" cy="40" r="18" fill="white" stroke="#000" stroke-width="2"/>
            <line x1="87" y1="27" x2="113" y2="53" stroke="#000" stroke-width="2"/>
            <line x1="113" y1="27" x2="87" y2="53" stroke="#000" stroke-width="2"/>
            <circle cx="180" cy="40" r="18" fill="white" stroke="#000" stroke-width="2"/>
            <line x1="167" y1="27" x2="193" y2="53" stroke="#000" stroke-width="2"/>
            <line x1="193" y1="27" x2="167" y2="53" stroke="#000" stroke-width="2"/>
            <circle cx="260" cy="40" r="18" fill="white" stroke="#000" stroke-width="2"/>
            <line x1="247" y1="27" x2="273" y2="53" stroke="#000" stroke-width="2"/>
            <line x1="273" y1="27" x2="247" y2="53" stroke="#000" stroke-width="2"/>
            <text x="100" y="80" text-anchor="middle" font-family="serif" font-size="10">L‚ÇÅ</text>
            <text x="180" y="80" text-anchor="middle" font-family="serif" font-size="10">L‚ÇÇ</text>
            <text x="260" y="80" text-anchor="middle" font-family="serif" font-size="10">L‚ÇÉ</text>
            <text x="100" y="18" text-anchor="middle" font-family="serif" font-size="9"><tspan font-style="italic">U</tspan>‚ÇÅ = 4 V</text>
            <text x="180" y="18" text-anchor="middle" font-family="serif" font-size="9"><tspan font-style="italic">U</tspan>‚ÇÇ = 6 V</text>
            <text x="260" y="18" text-anchor="middle" font-family="serif" font-size="9" fill="#c00" font-weight="bold"><tspan font-style="italic">U</tspan>‚ÇÉ = ?</text>
        </svg>`,
        unit: 'V',
        correct: { value: 8, tolerance: 0.1 },
        solution: 'U‚ÇÉ = 18 V ‚àí 4 V ‚àí 6 V = 8 V'
    },
    {
        id: 'S2-F9', type: 'number', points: 5, afb: 'II',
        text: 'Gemischte Schaltung: (L‚ÇÅ + L‚ÇÇ) in Reihe, parallel zu L‚ÇÉ. Gesamtspannung 24 V. <em>U</em>‚ÇÅ = 10 V. Berechne <em>U</em>‚ÇÇ.',
        svg: `<svg width="380" height="200" viewBox="0 0 380 200">
            <line x1="40" y1="30" x2="100" y2="30" stroke="#000" stroke-width="2"/>
            <line x1="100" y1="30" x2="100" y2="130" stroke="#000" stroke-width="2"/>
            <line x1="100" y1="50" x2="130" y2="50" stroke="#000" stroke-width="2"/>
            <line x1="170" y1="50" x2="200" y2="50" stroke="#000" stroke-width="2"/>
            <line x1="240" y1="50" x2="290" y2="50" stroke="#000" stroke-width="2"/>
            <line x1="100" y1="110" x2="160" y2="110" stroke="#000" stroke-width="2"/>
            <line x1="200" y1="110" x2="290" y2="110" stroke="#000" stroke-width="2"/>
            <line x1="290" y1="50" x2="290" y2="110" stroke="#000" stroke-width="2"/>
            <line x1="290" y1="80" x2="340" y2="80" stroke="#000" stroke-width="2"/>
            <line x1="340" y1="80" x2="340" y2="170" stroke="#000" stroke-width="2"/>
            <line x1="340" y1="170" x2="220" y2="170" stroke="#000" stroke-width="2"/>
            <line x1="220" y1="158" x2="220" y2="182" stroke="#000" stroke-width="2"/>
            <line x1="200" y1="162" x2="200" y2="178" stroke="#000" stroke-width="4"/>
            <text x="210" y="195" font-family="serif" font-size="9">24 V</text>
            <line x1="200" y1="170" x2="40" y2="170" stroke="#000" stroke-width="2"/>
            <line x1="40" y1="170" x2="40" y2="30" stroke="#000" stroke-width="2"/>
            <circle cx="150" cy="50" r="18" fill="white" stroke="#000" stroke-width="2"/>
            <line x1="137" y1="37" x2="163" y2="63" stroke="#000" stroke-width="2"/>
            <line x1="163" y1="37" x2="137" y2="63" stroke="#000" stroke-width="2"/>
            <circle cx="220" cy="50" r="18" fill="white" stroke="#000" stroke-width="2"/>
            <line x1="207" y1="37" x2="233" y2="63" stroke="#000" stroke-width="2"/>
            <line x1="233" y1="37" x2="207" y2="63" stroke="#000" stroke-width="2"/>
            <circle cx="180" cy="110" r="18" fill="white" stroke="#000" stroke-width="2"/>
            <line x1="167" y1="97" x2="193" y2="123" stroke="#000" stroke-width="2"/>
            <line x1="193" y1="97" x2="167" y2="123" stroke="#000" stroke-width="2"/>
            <text x="150" y="25" text-anchor="middle" font-family="serif" font-size="9">L‚ÇÅ: <tspan font-style="italic">U</tspan>‚ÇÅ = 10 V</text>
            <text x="220" y="25" text-anchor="middle" font-family="serif" font-size="9" fill="#c00" font-weight="bold">L‚ÇÇ: <tspan font-style="italic">U</tspan>‚ÇÇ = ?</text>
            <text x="240" y="115" font-family="serif" font-size="9" fill="#c00" font-weight="bold">L‚ÇÉ: <tspan font-style="italic">U</tspan>‚ÇÉ = ?</text>
        </svg>`,
        unit: 'V',
        correct: { value: 14, tolerance: 0.1 },
        solution: 'U‚ÇÉ = U_ges = 24 V (Parallel); U‚ÇÇ = 24 V ‚àí 10 V = 14 V (Reihe oben)'
    }
];

// ============================================================
// FRAGEN - STERN3 (14 Fragen, 52 Punkte)
// ============================================================
const QUESTIONS_STERN3 = [
    {
        id: 'S3-F1', type: 'dropdown', points: 4, afb: 'II',
        text: 'Ordne die Regeln der richtigen Schaltungsart zu:',
        dropdowns: [
            { id: 'd1', label: 'Die Stromst√§rke ist an allen Stellen gleich gro√ü:', options: ['Reihenschaltung', 'Parallelschaltung'], correct: 'Reihenschaltung' },
            { id: 'd2', label: 'Die Teilstr√∂me addieren sich zum Gesamtstrom:', options: ['Reihenschaltung', 'Parallelschaltung'], correct: 'Parallelschaltung' },
            { id: 'd3', label: 'Die Teilspannungen addieren sich zur Gesamtspannung:', options: ['Reihenschaltung', 'Parallelschaltung'], correct: 'Reihenschaltung' },
            { id: 'd4', label: 'An allen Zweigen liegt dieselbe Spannung:', options: ['Reihenschaltung', 'Parallelschaltung'], correct: 'Parallelschaltung' }
        ]
    },
    {
        id: 'S3-F2', type: 'dropdown', points: 2, afb: 'I',
        text: 'Vervollst√§ndige die Definitionen:',
        dropdowns: [
            { id: 'd1', label: 'Die Stromst√§rke gibt an, wie viel ____ pro Zeit flie√üt:', options: ['Energie', 'Ladung', 'Spannung', 'Widerstand'], correct: 'Ladung' },
            { id: 'd2', label: 'Die Spannung gibt an, wie viel ____ pro Ladung √ºbertragen wird:', options: ['Energie', 'Ladung', 'Stromst√§rke', 'Widerstand'], correct: 'Energie' }
        ]
    },
    {
        id: 'S3-F3', type: 'multicheck', points: 3, afb: 'I',
        text: 'Welche Aussagen gelten f√ºr die <strong>Reihenschaltung</strong>? (Mehrfachauswahl)',
        options: [
            { text: 'Die Stromst√§rke ist an allen Stellen gleich gro√ü', correct: true },
            { text: 'Die Teilspannungen addieren sich zur Gesamtspannung', correct: true },
            { text: 'Die Teilstr√∂me addieren sich zum Gesamtstrom', correct: false },
            { text: 'An allen Stellen liegt dieselbe Spannung', correct: false }
        ]
    },
    {
        id: 'S3-F4', type: 'multicheck', points: 3, afb: 'I',
        text: 'Welche Aussagen gelten f√ºr die <strong>Parallelschaltung</strong>? (Mehrfachauswahl)',
        options: [
            { text: 'Die Stromst√§rke ist √ºberall gleich gro√ü', correct: false },
            { text: 'Die Teilstr√∂me addieren sich zum Gesamtstrom', correct: true },
            { text: 'An allen Zweigen liegt dieselbe Spannung', correct: true },
            { text: 'Die Teilspannungen addieren sich', correct: false }
        ]
    },
    {
        id: 'S3-F5', type: 'number', points: 5, afb: 'II',
        text: 'Gemischte Schaltung: (L‚ÇÅ + L‚ÇÇ) in Reihe, parallel zu L‚ÇÉ. <em>I</em><sub>ges</sub> = 1,5 A, <em>I</em>‚ÇÉ = 0,9 A. Berechne <em>I</em>‚ÇÅ und <em>I</em>‚ÇÇ.',
        svg: `<svg width="380" height="200" viewBox="0 0 380 200">
            <line x1="40" y1="30" x2="100" y2="30" stroke="#000" stroke-width="2"/>
            <line x1="100" y1="30" x2="100" y2="130" stroke="#000" stroke-width="2"/>
            <line x1="100" y1="50" x2="130" y2="50" stroke="#000" stroke-width="2"/>
            <line x1="170" y1="50" x2="200" y2="50" stroke="#000" stroke-width="2"/>
            <line x1="240" y1="50" x2="290" y2="50" stroke="#000" stroke-width="2"/>
            <line x1="100" y1="110" x2="160" y2="110" stroke="#000" stroke-width="2"/>
            <line x1="200" y1="110" x2="290" y2="110" stroke="#000" stroke-width="2"/>
            <line x1="290" y1="50" x2="290" y2="110" stroke="#000" stroke-width="2"/>
            <line x1="290" y1="80" x2="340" y2="80" stroke="#000" stroke-width="2"/>
            <line x1="340" y1="80" x2="340" y2="170" stroke="#000" stroke-width="2"/>
            <line x1="340" y1="170" x2="220" y2="170" stroke="#000" stroke-width="2"/>
            <line x1="220" y1="158" x2="220" y2="182" stroke="#000" stroke-width="2"/>
            <line x1="200" y1="162" x2="200" y2="178" stroke="#000" stroke-width="4"/>
            <line x1="200" y1="170" x2="40" y2="170" stroke="#000" stroke-width="2"/>
            <line x1="40" y1="170" x2="40" y2="30" stroke="#000" stroke-width="2"/>
            <circle cx="150" cy="50" r="18" fill="white" stroke="#000" stroke-width="2"/>
            <line x1="137" y1="37" x2="163" y2="63" stroke="#000" stroke-width="2"/>
            <line x1="163" y1="37" x2="137" y2="63" stroke="#000" stroke-width="2"/>
            <circle cx="220" cy="50" r="18" fill="white" stroke="#000" stroke-width="2"/>
            <line x1="207" y1="37" x2="233" y2="63" stroke="#000" stroke-width="2"/>
            <line x1="233" y1="37" x2="207" y2="63" stroke="#000" stroke-width="2"/>
            <circle cx="180" cy="110" r="18" fill="white" stroke="#000" stroke-width="2"/>
            <line x1="167" y1="97" x2="193" y2="123" stroke="#000" stroke-width="2"/>
            <line x1="193" y1="97" x2="167" y2="123" stroke="#000" stroke-width="2"/>
            <text x="150" y="25" text-anchor="middle" font-family="serif" font-size="9" fill="#c00" font-weight="bold">L‚ÇÅ: <tspan font-style="italic">I</tspan>‚ÇÅ = ?</text>
            <text x="220" y="25" text-anchor="middle" font-family="serif" font-size="9" fill="#c00" font-weight="bold">L‚ÇÇ: <tspan font-style="italic">I</tspan>‚ÇÇ = ?</text>
            <text x="240" y="115" font-family="serif" font-size="9">L‚ÇÉ: <tspan font-style="italic">I</tspan>‚ÇÉ = 0,9 A</text>
            <text x="60" y="20" font-family="serif" font-size="9"><tspan font-style="italic">I</tspan><tspan font-size="7" baseline-shift="sub">ges</tspan> = 1,5 A</text>
        </svg>`,
        unit: 'A',
        correct: { value: 0.6, tolerance: 0.01 },
        solution: 'I‚ÇÅ,‚ÇÇ = 1,5 A ‚àí 0,9 A = 0,6 A; Reihe: I‚ÇÅ = I‚ÇÇ = 0,6 A'
    },
    {
        id: 'S3-F6', type: 'number', points: 3, afb: 'II',
        text: 'Drei Zweige parallel: <em>I</em>‚ÇÅ = 200 mA, <em>I</em>‚ÇÇ = 0,35 A, <em>I</em>‚ÇÉ = 450 mA. Berechne <em>I</em><sub>ges</sub> in Ampere.',
        unit: 'A',
        correct: { value: 1, tolerance: 0.01 },
        solution: '200 mA = 0,2 A; 450 mA = 0,45 A ‚Üí I_ges = 0,2 + 0,35 + 0,45 = 1 A'
    },
    {
        id: 'S3-F7', type: 'number', points: 3, afb: 'II',
        text: 'Motor M‚ÇÅ in Reihe mit zwei parallel geschalteten Motoren M‚ÇÇ und M‚ÇÉ. <em>I</em>‚ÇÅ = 2 A, <em>I</em>‚ÇÇ = 1,2 A. Berechne <em>I</em>‚ÇÉ.',
        svg: `<svg width="380" height="180" viewBox="0 0 380 180">
            <line x1="40" y1="40" x2="80" y2="40" stroke="#000" stroke-width="2"/>
            <line x1="120" y1="40" x2="160" y2="40" stroke="#000" stroke-width="2"/>
            <line x1="160" y1="40" x2="160" y2="120" stroke="#000" stroke-width="2"/>
            <line x1="160" y1="55" x2="200" y2="55" stroke="#000" stroke-width="2"/>
            <line x1="240" y1="55" x2="290" y2="55" stroke="#000" stroke-width="2"/>
            <line x1="160" y1="105" x2="200" y2="105" stroke="#000" stroke-width="2"/>
            <line x1="240" y1="105" x2="290" y2="105" stroke="#000" stroke-width="2"/>
            <line x1="290" y1="55" x2="290" y2="105" stroke="#000" stroke-width="2"/>
            <line x1="290" y1="80" x2="340" y2="80" stroke="#000" stroke-width="2"/>
            <line x1="340" y1="80" x2="340" y2="150" stroke="#000" stroke-width="2"/>
            <line x1="340" y1="150" x2="220" y2="150" stroke="#000" stroke-width="2"/>
            <line x1="220" y1="138" x2="220" y2="162" stroke="#000" stroke-width="2"/>
            <line x1="200" y1="142" x2="200" y2="158" stroke="#000" stroke-width="4"/>
            <line x1="200" y1="150" x2="40" y2="150" stroke="#000" stroke-width="2"/>
            <line x1="40" y1="150" x2="40" y2="40" stroke="#000" stroke-width="2"/>
            <circle cx="100" cy="40" r="18" fill="white" stroke="#000" stroke-width="2"/>
            <text x="100" y="45" text-anchor="middle" font-family="serif" font-size="10" font-weight="bold">M</text>
            <circle cx="220" cy="55" r="18" fill="white" stroke="#000" stroke-width="2"/>
            <text x="220" y="60" text-anchor="middle" font-family="serif" font-size="10" font-weight="bold">M</text>
            <circle cx="220" cy="105" r="18" fill="white" stroke="#000" stroke-width="2"/>
            <text x="220" y="110" text-anchor="middle" font-family="serif" font-size="10" font-weight="bold">M</text>
            <text x="100" y="75" text-anchor="middle" font-family="serif" font-size="9">M‚ÇÅ: <tspan font-style="italic">I</tspan>‚ÇÅ = 2 A</text>
            <text x="260" y="50" font-family="serif" font-size="9">M‚ÇÇ: <tspan font-style="italic">I</tspan>‚ÇÇ = 1,2 A</text>
            <text x="260" y="110" font-family="serif" font-size="9" fill="#c00" font-weight="bold">M‚ÇÉ: <tspan font-style="italic">I</tspan>‚ÇÉ = ?</text>
        </svg>`,
        unit: 'A',
        correct: { value: 0.8, tolerance: 0.01 },
        solution: 'I‚ÇÅ = I‚ÇÇ + I‚ÇÉ (Strom teilt sich) ‚Üí I‚ÇÉ = 2 A ‚àí 1,2 A = 0,8 A'
    },
    {
        id: 'S3-F8', type: 'text', points: 3, afb: 'III',
        text: 'Fehleranalyse: Ein Sch√ºler misst in einer Parallelschaltung:<br><em>I</em><sub>ges</sub> = 1,5 A, <em>I</em>‚ÇÅ = 0,6 A, <em>I</em>‚ÇÇ = 0,7 A, <em>I</em>‚ÇÉ = 0,4 A<br>Pr√ºfe die Werte. Welcher ist falsch?',
        fields: [
            { id: 'f1', label: 'Summe der Teilstr√∂me:', correct: ['1,7', '1.7', '1,7 A', '1.7 A'], points: 1 },
            { id: 'f2', label: 'Differenz:', correct: ['0,2', '0.2', '0,2 A', '0.2 A'], points: 1 },
            { id: 'f3', label: 'Ergebnis:', correct: ['falsch', 'Fehler', 'inkonsistent', 'stimmt nicht', 'mindestens einer'], points: 1 }
        ],
        solution: 'Summe: 0,6 + 0,7 + 0,4 = 1,7 A ‚â† 1,5 A ‚Üí Mindestens ein Wert ist falsch'
    }
];

// STERN3 Fortsetzung (F9-F14)
QUESTIONS_STERN3.push(
    {
        id: 'S3-F9', type: 'number', points: 5, afb: 'III',
        text: '<strong>Verschachtelte Schaltung:</strong> L‚ÇÅ und L‚ÇÇ in Reihe, parallel zu L‚ÇÉ. Gesamtspannung 18 V, <em>U</em>‚ÇÅ = 6 V. Berechne <em>U</em>‚ÇÇ.',
        svg: `<svg width="400" height="200" viewBox="0 0 400 200">
            <line x1="40" y1="30" x2="100" y2="30" stroke="#000" stroke-width="2"/>
            <line x1="100" y1="30" x2="100" y2="130" stroke="#000" stroke-width="2"/>
            <line x1="100" y1="50" x2="130" y2="50" stroke="#000" stroke-width="2"/>
            <line x1="170" y1="50" x2="200" y2="50" stroke="#000" stroke-width="2"/>
            <line x1="240" y1="50" x2="300" y2="50" stroke="#000" stroke-width="2"/>
            <line x1="100" y1="110" x2="160" y2="110" stroke="#000" stroke-width="2"/>
            <line x1="200" y1="110" x2="300" y2="110" stroke="#000" stroke-width="2"/>
            <line x1="300" y1="50" x2="300" y2="110" stroke="#000" stroke-width="2"/>
            <line x1="300" y1="80" x2="360" y2="80" stroke="#000" stroke-width="2"/>
            <line x1="360" y1="80" x2="360" y2="170" stroke="#000" stroke-width="2"/>
            <line x1="360" y1="170" x2="240" y2="170" stroke="#000" stroke-width="2"/>
            <line x1="240" y1="158" x2="240" y2="182" stroke="#000" stroke-width="2"/>
            <line x1="220" y1="162" x2="220" y2="178" stroke="#000" stroke-width="4"/>
            <text x="230" y="195" font-family="serif" font-size="9">18 V</text>
            <line x1="220" y1="170" x2="40" y2="170" stroke="#000" stroke-width="2"/>
            <line x1="40" y1="170" x2="40" y2="30" stroke="#000" stroke-width="2"/>
            <circle cx="150" cy="50" r="18" fill="white" stroke="#000" stroke-width="2"/>
            <line x1="137" y1="37" x2="163" y2="63" stroke="#000" stroke-width="2"/>
            <line x1="163" y1="37" x2="137" y2="63" stroke="#000" stroke-width="2"/>
            <circle cx="220" cy="50" r="18" fill="white" stroke="#000" stroke-width="2"/>
            <line x1="207" y1="37" x2="233" y2="63" stroke="#000" stroke-width="2"/>
            <line x1="233" y1="37" x2="207" y2="63" stroke="#000" stroke-width="2"/>
            <circle cx="180" cy="110" r="18" fill="white" stroke="#000" stroke-width="2"/>
            <line x1="167" y1="97" x2="193" y2="123" stroke="#000" stroke-width="2"/>
            <line x1="193" y1="97" x2="167" y2="123" stroke="#000" stroke-width="2"/>
            <text x="150" y="25" text-anchor="middle" font-family="serif" font-size="9">L‚ÇÅ: <tspan font-style="italic">U</tspan>‚ÇÅ = 6 V</text>
            <text x="220" y="25" text-anchor="middle" font-family="serif" font-size="9" fill="#c00" font-weight="bold">L‚ÇÇ: <tspan font-style="italic">U</tspan>‚ÇÇ = ?</text>
            <text x="240" y="115" font-family="serif" font-size="9" fill="#c00" font-weight="bold">L‚ÇÉ: <tspan font-style="italic">U</tspan>‚ÇÉ = ?</text>
        </svg>`,
        unit: 'V',
        correct: { value: 12, tolerance: 0.1 },
        solution: 'U‚ÇÉ = U_ges = 18 V (Parallel); U‚ÇÇ = 18 V ‚àí 6 V = 12 V (Reihe)'
    },
    {
        id: 'S3-F10', type: 'number', points: 3, afb: 'II',
        text: 'Eine Lichterkette mit 20 gleichen Lampen in Reihe an 230 V. Berechne die Spannung pro Lampe.',
        unit: 'V',
        correct: { value: 11.5, tolerance: 0.1 },
        solution: 'Gleiche Lampen ‚Üí U = 230 V √∑ 20 = 11,5 V'
    },
    {
        id: 'S3-F11', type: 'text', points: 3, afb: 'III',
        text: 'Fehleranalyse: Ein Sch√ºler misst in einer Reihenschaltung an 48 V:<br><em>U</em>‚ÇÅ = 18 V, <em>U</em>‚ÇÇ = 20 V, <em>U</em>‚ÇÉ = 15 V<br>Pr√ºfe die Werte.',
        fields: [
            { id: 'f1', label: 'Summe der Teilspannungen:', correct: ['53', '53 V'], points: 1 },
            { id: 'f2', label: 'Differenz:', correct: ['5', '5 V'], points: 1 },
            { id: 'f3', label: 'Ergebnis:', correct: ['falsch', 'Fehler', 'inkonsistent', 'stimmt nicht'], points: 1 }
        ],
        solution: 'Summe: 18 + 20 + 15 = 53 V ‚â† 48 V ‚Üí Mindestens ein Wert ist falsch'
    },
    {
        id: 'S3-F12', type: 'number', points: 3, afb: 'II',
        text: 'Drei Lampen in Reihe: <em>U</em>‚ÇÅ = 4,5 V, <em>U</em>‚ÇÇ = 3500 mV, <em>U</em>‚ÇÉ = 4 V. Berechne <em>U</em><sub>ges</sub> in Volt.',
        unit: 'V',
        correct: { value: 12, tolerance: 0.1 },
        solution: '3500 mV = 3,5 V ‚Üí U_ges = 4,5 V + 3,5 V + 4 V = 12 V'
    },
    {
        id: 'S3-F13', type: 'number', points: 6, afb: 'III',
        text: '<strong style="color:#d32f2f;">üî• EXTREM:</strong> Struktur: (L‚ÇÅ‚ÄìL‚ÇÇ) parallel zu (L‚ÇÉ parallel zu (L‚ÇÑ || L‚ÇÖ))<br><em>I</em><sub>ges</sub> = 3 A, <em>I</em>‚ÇÅ,‚ÇÇ = 0,8 A, <em>I</em>‚ÇÑ = 0,6 A, <em>I</em>‚ÇÖ = 0,4 A. Berechne <em>I</em>‚ÇÉ.',
        svg: `<svg width="450" height="280" viewBox="0 0 450 280">
            <line x1="40" y1="30" x2="100" y2="30" stroke="#000" stroke-width="2"/>
            <line x1="100" y1="30" x2="100" y2="220" stroke="#000" stroke-width="2"/>
            <line x1="100" y1="50" x2="140" y2="50" stroke="#000" stroke-width="2"/>
            <line x1="180" y1="50" x2="220" y2="50" stroke="#000" stroke-width="2"/>
            <line x1="260" y1="50" x2="340" y2="50" stroke="#000" stroke-width="2"/>
            <line x1="100" y1="130" x2="150" y2="130" stroke="#000" stroke-width="2"/>
            <line x1="150" y1="100" x2="150" y2="200" stroke="#000" stroke-width="2"/>
            <line x1="150" y1="110" x2="190" y2="110" stroke="#000" stroke-width="2"/>
            <line x1="230" y1="110" x2="300" y2="110" stroke="#000" stroke-width="2"/>
            <line x1="150" y1="180" x2="200" y2="180" stroke="#000" stroke-width="2"/>
            <line x1="200" y1="150" x2="200" y2="210" stroke="#000" stroke-width="2"/>
            <line x1="200" y1="160" x2="230" y2="160" stroke="#000" stroke-width="2"/>
            <line x1="270" y1="160" x2="300" y2="160" stroke="#000" stroke-width="2"/>
            <line x1="200" y1="200" x2="230" y2="200" stroke="#000" stroke-width="2"/>
            <line x1="270" y1="200" x2="300" y2="200" stroke="#000" stroke-width="2"/>
            <line x1="300" y1="160" x2="300" y2="200" stroke="#000" stroke-width="2"/>
            <line x1="300" y1="180" x2="300" y2="110" stroke="#000" stroke-width="2"/>
            <line x1="300" y1="110" x2="340" y2="110" stroke="#000" stroke-width="2"/>
            <line x1="340" y1="50" x2="340" y2="110" stroke="#000" stroke-width="2"/>
            <line x1="340" y1="80" x2="400" y2="80" stroke="#000" stroke-width="2"/>
            <line x1="400" y1="80" x2="400" y2="250" stroke="#000" stroke-width="2"/>
            <line x1="400" y1="250" x2="260" y2="250" stroke="#000" stroke-width="2"/>
            <line x1="260" y1="238" x2="260" y2="262" stroke="#000" stroke-width="2"/>
            <line x1="240" y1="242" x2="240" y2="258" stroke="#000" stroke-width="4"/>
            <line x1="240" y1="250" x2="40" y2="250" stroke="#000" stroke-width="2"/>
            <line x1="40" y1="250" x2="40" y2="30" stroke="#000" stroke-width="2"/>
            <circle cx="160" cy="50" r="18" fill="white" stroke="#000" stroke-width="2"/>
            <line x1="147" y1="37" x2="173" y2="63" stroke="#000" stroke-width="2"/>
            <line x1="173" y1="37" x2="147" y2="63" stroke="#000" stroke-width="2"/>
            <circle cx="240" cy="50" r="18" fill="white" stroke="#000" stroke-width="2"/>
            <line x1="227" y1="37" x2="253" y2="63" stroke="#000" stroke-width="2"/>
            <line x1="253" y1="37" x2="227" y2="63" stroke="#000" stroke-width="2"/>
            <circle cx="210" cy="110" r="18" fill="white" stroke="#000" stroke-width="2"/>
            <line x1="197" y1="97" x2="223" y2="123" stroke="#000" stroke-width="2"/>
            <line x1="223" y1="97" x2="197" y2="123" stroke="#000" stroke-width="2"/>
            <circle cx="250" cy="160" r="18" fill="white" stroke="#000" stroke-width="2"/>
            <line x1="237" y1="147" x2="263" y2="173" stroke="#000" stroke-width="2"/>
            <line x1="263" y1="147" x2="237" y2="173" stroke="#000" stroke-width="2"/>
            <circle cx="250" cy="200" r="18" fill="white" stroke="#000" stroke-width="2"/>
            <line x1="237" y1="187" x2="263" y2="213" stroke="#000" stroke-width="2"/>
            <line x1="263" y1="187" x2="237" y2="213" stroke="#000" stroke-width="2"/>
            <text x="160" y="25" text-anchor="middle" font-family="serif" font-size="9">L‚ÇÅ</text>
            <text x="240" y="25" text-anchor="middle" font-family="serif" font-size="9">L‚ÇÇ</text>
            <text x="300" y="45" font-family="serif" font-size="8"><tspan font-style="italic">I</tspan>‚ÇÅ,‚ÇÇ = 0,8 A</text>
            <text x="210" y="140" text-anchor="middle" font-family="serif" font-size="9" fill="#c00" font-weight="bold">L‚ÇÉ: <tspan font-style="italic">I</tspan>‚ÇÉ = ?</text>
            <text x="320" y="160" font-family="serif" font-size="8">L‚ÇÑ: <tspan font-style="italic">I</tspan>‚ÇÑ = 0,6 A</text>
            <text x="320" y="205" font-family="serif" font-size="8">L‚ÇÖ: <tspan font-style="italic">I</tspan>‚ÇÖ = 0,4 A</text>
            <text x="60" y="20" font-family="serif" font-size="9"><tspan font-style="italic">I</tspan><tspan font-size="7" baseline-shift="sub">ges</tspan> = 3 A</text>
        </svg>`,
        unit: 'A',
        correct: { value: 1.2, tolerance: 0.01 },
        solution: 'I_unten = 3 A ‚àí 0,8 A = 2,2 A; I‚ÇÑ,‚ÇÖ = 0,6 + 0,4 = 1,0 A; I‚ÇÉ = 2,2 ‚àí 1,0 = 1,2 A'
    },
    {
        id: 'S3-F14', type: 'number', points: 6, afb: 'III',
        text: '<strong style="color:#d32f2f;">üî• EXTREM:</strong> Struktur: (L‚ÇÅ‚ÄìL‚ÇÇ) parallel zu (L‚ÇÉ || (L‚ÇÑ || L‚ÇÖ))<br><em>U</em><sub>ges</sub> = 24 V, <em>U</em>‚ÇÅ = 8 V. Berechne <em>U</em>‚ÇÇ.',
        svg: `<svg width="450" height="280" viewBox="0 0 450 280">
            <line x1="40" y1="30" x2="100" y2="30" stroke="#000" stroke-width="2"/>
            <line x1="100" y1="30" x2="100" y2="220" stroke="#000" stroke-width="2"/>
            <line x1="100" y1="50" x2="140" y2="50" stroke="#000" stroke-width="2"/>
            <line x1="180" y1="50" x2="220" y2="50" stroke="#000" stroke-width="2"/>
            <line x1="260" y1="50" x2="340" y2="50" stroke="#000" stroke-width="2"/>
            <line x1="100" y1="130" x2="150" y2="130" stroke="#000" stroke-width="2"/>
            <line x1="150" y1="100" x2="150" y2="200" stroke="#000" stroke-width="2"/>
            <line x1="150" y1="110" x2="190" y2="110" stroke="#000" stroke-width="2"/>
            <line x1="230" y1="110" x2="300" y2="110" stroke="#000" stroke-width="2"/>
            <line x1="150" y1="180" x2="200" y2="180" stroke="#000" stroke-width="2"/>
            <line x1="200" y1="150" x2="200" y2="210" stroke="#000" stroke-width="2"/>
            <line x1="200" y1="160" x2="230" y2="160" stroke="#000" stroke-width="2"/>
            <line x1="270" y1="160" x2="300" y2="160" stroke="#000" stroke-width="2"/>
            <line x1="200" y1="200" x2="230" y2="200" stroke="#000" stroke-width="2"/>
            <line x1="270" y1="200" x2="300" y2="200" stroke="#000" stroke-width="2"/>
            <line x1="300" y1="160" x2="300" y2="200" stroke="#000" stroke-width="2"/>
            <line x1="300" y1="180" x2="300" y2="110" stroke="#000" stroke-width="2"/>
            <line x1="300" y1="110" x2="340" y2="110" stroke="#000" stroke-width="2"/>
            <line x1="340" y1="50" x2="340" y2="110" stroke="#000" stroke-width="2"/>
            <line x1="340" y1="80" x2="400" y2="80" stroke="#000" stroke-width="2"/>
            <line x1="400" y1="80" x2="400" y2="250" stroke="#000" stroke-width="2"/>
            <line x1="400" y1="250" x2="260" y2="250" stroke="#000" stroke-width="2"/>
            <line x1="260" y1="238" x2="260" y2="262" stroke="#000" stroke-width="2"/>
            <line x1="240" y1="242" x2="240" y2="258" stroke="#000" stroke-width="4"/>
            <text x="250" y="272" font-family="serif" font-size="9">24 V</text>
            <line x1="240" y1="250" x2="40" y2="250" stroke="#000" stroke-width="2"/>
            <line x1="40" y1="250" x2="40" y2="30" stroke="#000" stroke-width="2"/>
            <circle cx="160" cy="50" r="18" fill="white" stroke="#000" stroke-width="2"/>
            <line x1="147" y1="37" x2="173" y2="63" stroke="#000" stroke-width="2"/>
            <line x1="173" y1="37" x2="147" y2="63" stroke="#000" stroke-width="2"/>
            <circle cx="240" cy="50" r="18" fill="white" stroke="#000" stroke-width="2"/>
            <line x1="227" y1="37" x2="253" y2="63" stroke="#000" stroke-width="2"/>
            <line x1="253" y1="37" x2="227" y2="63" stroke="#000" stroke-width="2"/>
            <circle cx="210" cy="110" r="18" fill="white" stroke="#000" stroke-width="2"/>
            <line x1="197" y1="97" x2="223" y2="123" stroke="#000" stroke-width="2"/>
            <line x1="223" y1="97" x2="197" y2="123" stroke="#000" stroke-width="2"/>
            <circle cx="250" cy="160" r="18" fill="white" stroke="#000" stroke-width="2"/>
            <line x1="237" y1="147" x2="263" y2="173" stroke="#000" stroke-width="2"/>
            <line x1="263" y1="147" x2="237" y2="173" stroke="#000" stroke-width="2"/>
            <circle cx="250" cy="200" r="18" fill="white" stroke="#000" stroke-width="2"/>
            <line x1="237" y1="187" x2="263" y2="213" stroke="#000" stroke-width="2"/>
            <line x1="263" y1="187" x2="237" y2="213" stroke="#000" stroke-width="2"/>
            <text x="160" y="25" text-anchor="middle" font-family="serif" font-size="9">L‚ÇÅ: <tspan font-style="italic">U</tspan>‚ÇÅ = 8 V</text>
            <text x="240" y="25" text-anchor="middle" font-family="serif" font-size="9" fill="#c00" font-weight="bold">L‚ÇÇ: <tspan font-style="italic">U</tspan>‚ÇÇ = ?</text>
            <text x="210" y="140" text-anchor="middle" font-family="serif" font-size="9" fill="#c00" font-weight="bold">L‚ÇÉ: <tspan font-style="italic">U</tspan>‚ÇÉ = ?</text>
            <text x="320" y="160" font-family="serif" font-size="8" fill="#c00" font-weight="bold">L‚ÇÑ: <tspan font-style="italic">U</tspan>‚ÇÑ = ?</text>
            <text x="320" y="205" font-family="serif" font-size="8" fill="#c00" font-weight="bold">L‚ÇÖ: <tspan font-style="italic">U</tspan>‚ÇÖ = ?</text>
        </svg>`,
        unit: 'V',
        correct: { value: 16, tolerance: 0.1 },
        solution: 'U‚ÇÇ = 24 V ‚àí 8 V = 16 V; U‚ÇÉ = U‚ÇÑ = U‚ÇÖ = U_ges = 24 V (alle parallel)'
    }
);

// ============================================================
// FRAGEN-OBJEKT
// ============================================================
const QUESTIONS = {
    basis: QUESTIONS_BASIS,
    stern1: QUESTIONS_STERN1,
    stern2: QUESTIONS_STERN2,
    stern3: QUESTIONS_STERN3
};

// ============================================================
// STATE
// ============================================================
let state = {
    niveau: null,
    seat: null,
    questions: [],
    currentIndex: 0,
    answers: {},
    startTime: null,
    timeRemaining: CONFIG.TEST_DURATION * 60,
    submitted: false,
    submissionCode: null,
    gradedAnswers: [],
    totalEarned: 0,
    elapsed: 0
};

let timerInterval = null;

// ============================================================
// STORAGE
// ============================================================
function getStorageKey() {
    return CONFIG.STORAGE_KEY_PREFIX + (state.niveau || 'default');
}

function saveState() {
    if (!state.niveau) return;
    const data = {
        version: CONFIG.VERSION,
        niveau: state.niveau,
        seat: state.seat,
        answers: state.answers,
        startTime: state.startTime,
        timeRemaining: state.timeRemaining,
        submitted: state.submitted,
        submissionCode: state.submissionCode,
        gradedAnswers: state.gradedAnswers,
        totalEarned: state.totalEarned,
        elapsed: state.elapsed,
        currentIndex: state.currentIndex
    };
    localStorage.setItem(getStorageKey(), JSON.stringify(data));
}

function loadState(niveau) {
    const key = CONFIG.STORAGE_KEY_PREFIX + niveau;
    const saved = localStorage.getItem(key);
    if (!saved) return null;
    try {
        return JSON.parse(saved);
    } catch (e) {
        return null;
    }
}

function clearState() {
    if (state.niveau) {
        localStorage.removeItem(getStorageKey());
    }
}

// ============================================================
// HILFSFUNKTIONEN
// ============================================================
function formatTime(seconds) {
    const m = Math.floor(seconds / 60);
    const s = seconds % 60;
    return `${m}:${s.toString().padStart(2, '0')}`;
}

function calculateGrade(percent, totalPoints) {
    for (const g of CONFIG.GRADE_SCALE) {
        if (percent >= g.pct) return g.np;
    }
    return 0;
}

function normalizeAnswer(str) {
    if (!str) return '';
    return str.toString().toLowerCase()
        .replace(/,/g, '.')
        .replace(/\s+/g, '')
        .trim();
}

function checkNumberAnswer(given, correct) {
    const num = parseFloat(normalizeAnswer(given).replace(',', '.'));
    if (isNaN(num)) return false;
    return Math.abs(num - correct.value) <= correct.tolerance;
}

function checkTextAnswer(given, acceptedList) {
    const norm = normalizeAnswer(given);
    return acceptedList.some(acc => normalizeAnswer(acc) === norm);
}

// ============================================================
// BEWERTUNG
// ============================================================
function gradeQuestion(q, answer) {
    let earned = 0;
    let details = [];
    
    if (q.type === 'mc') {
        if (answer === q.correct) {
            earned = q.points;
            details.push({ correct: true });
        }
    } else if (q.type === 'multicheck') {
        let correctCount = 0;
        q.options.forEach((opt, i) => {
            const checked = answer && answer.includes(i);
            if (checked === opt.correct) correctCount++;
        });
        const perOption = q.points / q.options.length;
        earned = Math.round(correctCount * perOption * 10) / 10;
    } else if (q.type === 'dropdown') {
        const perDrop = q.points / q.dropdowns.length;
        q.dropdowns.forEach(d => {
            if (answer && answer[d.id] === d.correct) {
                earned += perDrop;
            }
        });
        earned = Math.round(earned * 10) / 10;
    } else if (q.type === 'number') {
        if (q.multiAnswer && q.answers) {
            // Multiple number answers
            const perAns = q.points / q.answers.length;
            q.answers.forEach((a, i) => {
                const val = answer && answer[i];
                if (checkNumberAnswer(val, a.correct)) {
                    earned += perAns;
                }
            });
        } else {
            if (checkNumberAnswer(answer, q.correct)) {
                earned = q.points;
            }
        }
        earned = Math.round(earned * 10) / 10;
    } else if (q.type === 'text') {
        if (q.fields) {
            q.fields.forEach(f => {
                const val = answer && answer[f.id];
                if (checkTextAnswer(val, f.correct)) {
                    earned += f.points;
                }
            });
        } else {
            if (checkTextAnswer(answer, q.correct)) {
                earned = q.points;
            }
        }
    }
    
    return { earned, max: q.points };
}

function gradeAll() {
    state.gradedAnswers = [];
    state.totalEarned = 0;
    
    state.questions.forEach(q => {
        const answer = state.answers[q.id];
        const result = gradeQuestion(q, answer);
        state.gradedAnswers.push({
            id: q.id,
            earned: result.earned,
            max: result.max,
            answer: answer,
            question: q
        });
        state.totalEarned += result.earned;
    });
    
    state.totalEarned = Math.round(state.totalEarned * 10) / 10;
}

// ============================================================
// RENDERING
// ============================================================
function renderQuestion(q, index) {
    let html = `
        <div class="question-card">
            <div class="question-header">
                <span class="question-number">Frage ${index + 1} von ${state.questions.length}</span>
                <span class="question-points">${q.points} ${q.points === 1 ? 'Punkt' : 'Punkte'}</span>
            </div>
            <div class="question-text">${q.text}</div>
    `;
    
    if (q.svg) {
        html += `<div class="circuit-container">${q.svg}</div>`;
    }
    
    const answer = state.answers[q.id];
    
    if (q.type === 'mc') {
        html += '<div class="options">';
        ['A', 'B', 'C', 'D'].forEach((letter, i) => {
            if (q.options[i]) {
                const sel = answer === i ? 'selected' : '';
                html += `
                    <div class="option ${sel}" data-value="${i}">
                        <span class="option-letter">${letter}</span>
                        <span>${q.options[i]}</span>
                    </div>
                `;
            }
        });
        html += '</div>';
    } else if (q.type === 'multicheck') {
        html += '<div class="check-options">';
        q.options.forEach((opt, i) => {
            const checked = answer && answer.includes(i) ? 'checked' : '';
            html += `
                <div class="check-option ${checked}" data-value="${i}">
                    <span class="check-box">${checked ? '‚úì' : ''}</span>
                    <span>${opt.text}</span>
                </div>
            `;
        });
        html += '</div>';
    } else if (q.type === 'dropdown') {
        q.dropdowns.forEach(d => {
            const val = answer && answer[d.id] || '';
            html += `<div class="dropdown-row">`;
            html += `<span>${d.label}</span>`;
            html += `<select data-dropdown="${d.id}">`;
            html += `<option value="">‚Äì w√§hlen ‚Äì</option>`;
            d.options.forEach(opt => {
                const sel = val === opt ? 'selected' : '';
                html += `<option value="${opt}" ${sel}>${opt}</option>`;
            });
            html += `</select></div>`;
        });
    } else if (q.type === 'number') {
        if (q.multiAnswer && q.answers) {
            q.answers.forEach((a, i) => {
                const val = answer && answer[i] || '';
                html += `
                    <div class="number-input">
                        <span>${a.label} =</span>
                        <input type="text" inputmode="decimal" data-index="${i}" value="${val}" placeholder="?">
                        <span class="unit">${q.unit || ''}</span>
                    </div>
                `;
            });
        } else {
            const val = answer || '';
            html += `
                <div class="number-input">
                    <input type="text" inputmode="decimal" data-number="true" value="${val}" placeholder="Antwort">
                    <span class="unit">${q.unit || ''}</span>
                </div>
            `;
        }
    } else if (q.type === 'text') {
        if (q.fields) {
            q.fields.forEach(f => {
                const val = answer && answer[f.id] || '';
                html += `
                    <div class="text-input">
                        <label>${f.label}</label>
                        <input type="text" data-field="${f.id}" value="${val}" placeholder="Antwort">
                    </div>
                `;
            });
        } else {
            const val = answer || '';
            html += `
                <div class="text-input">
                    <input type="text" data-text="true" value="${val}" placeholder="Antwort">
                </div>
            `;
        }
    }
    
    html += '</div>';
    return html;
}

function updateQuestionNav() {
    const nav = document.getElementById('questionNav');
    let html = '';
    state.questions.forEach((q, i) => {
        const current = i === state.currentIndex ? 'current' : '';
        const answered = state.answers[q.id] !== undefined ? 'answered' : '';
        html += `<button class="nav-btn ${current} ${answered}" data-index="${i}">${i + 1}</button>`;
    });
    nav.innerHTML = html;
}

function updateProgress() {
    const answered = Object.keys(state.answers).length;
    const total = state.questions.length;
    const pct = (answered / total) * 100;
    document.getElementById('progressFill').style.width = pct + '%';
    document.getElementById('progressText').textContent = `Fortschritt: ${answered}/${total} Aufgaben`;
}

// ============================================================
// QUIZ FLOW
// ============================================================
function showScreen(screenId) {
    document.querySelectorAll('.screen').forEach(s => s.classList.remove('active'));
    document.getElementById(screenId).classList.add('active');
}

function startQuiz() {
    state.questions = QUESTIONS[state.niveau];
    state.startTime = Date.now();
    state.timeRemaining = CONFIG.TEST_DURATION * 60;
    state.currentIndex = 0;
    state.answers = {};
    state.submitted = false;
    
    const levelInfo = CONFIG.LEVELS[state.niveau];
    document.getElementById('levelBadge').textContent = `${levelInfo.symbol} ${levelInfo.name}`;
    
    showScreen('quizScreen');
    renderCurrentQuestion();
    updateQuestionNav();
    updateProgress();
    startTimer();
    saveState();
}

function renderCurrentQuestion() {
    const q = state.questions[state.currentIndex];
    document.getElementById('questionContainer').innerHTML = renderQuestion(q, state.currentIndex);
    attachQuestionHandlers();
    
    document.getElementById('prevBtn').disabled = state.currentIndex === 0;
    const isLast = state.currentIndex === state.questions.length - 1;
    const nextBtn = document.getElementById('nextBtn');
    if (isLast) {
        nextBtn.textContent = 'Abgeben ‚úì';
        nextBtn.classList.remove('next');
        nextBtn.classList.add('submit');
    } else {
        nextBtn.textContent = 'Weiter ‚Üí';
        nextBtn.classList.remove('submit');
        nextBtn.classList.add('next');
    }
}

function attachQuestionHandlers() {
    const q = state.questions[state.currentIndex];
    
    // MC
    document.querySelectorAll('.option').forEach(el => {
        el.addEventListener('click', () => {
            document.querySelectorAll('.option').forEach(o => o.classList.remove('selected'));
            el.classList.add('selected');
            state.answers[q.id] = parseInt(el.dataset.value);
            updateQuestionNav();
            updateProgress();
            saveState();
        });
    });
    
    // Multicheck
    document.querySelectorAll('.check-option').forEach(el => {
        el.addEventListener('click', () => {
            el.classList.toggle('checked');
            el.querySelector('.check-box').textContent = el.classList.contains('checked') ? '‚úì' : '';
            
            const selected = [];
            document.querySelectorAll('.check-option.checked').forEach(c => {
                selected.push(parseInt(c.dataset.value));
            });
            state.answers[q.id] = selected.length > 0 ? selected : undefined;
            updateQuestionNav();
            updateProgress();
            saveState();
        });
    });
    
    // Dropdowns
    document.querySelectorAll('select[data-dropdown]').forEach(sel => {
        sel.addEventListener('change', () => {
            if (!state.answers[q.id]) state.answers[q.id] = {};
            state.answers[q.id][sel.dataset.dropdown] = sel.value || undefined;
            
            // Check if all dropdowns have values
            let hasAny = false;
            q.dropdowns.forEach(d => {
                if (state.answers[q.id][d.id]) hasAny = true;
            });
            if (!hasAny) state.answers[q.id] = undefined;
            
            updateQuestionNav();
            updateProgress();
            saveState();
        });
    });
    
    // Number inputs
    document.querySelectorAll('input[data-number]').forEach(inp => {
        inp.addEventListener('input', () => {
            state.answers[q.id] = inp.value || undefined;
            updateQuestionNav();
            updateProgress();
            saveState();
        });
    });
    
    // Multi number inputs
    document.querySelectorAll('input[data-index]').forEach(inp => {
        inp.addEventListener('input', () => {
            if (!state.answers[q.id]) state.answers[q.id] = {};
            state.answers[q.id][inp.dataset.index] = inp.value || undefined;
            updateQuestionNav();
            updateProgress();
            saveState();
        });
    });
    
    // Text fields
    document.querySelectorAll('input[data-field]').forEach(inp => {
        inp.addEventListener('input', () => {
            if (!state.answers[q.id]) state.answers[q.id] = {};
            state.answers[q.id][inp.dataset.field] = inp.value || undefined;
            updateQuestionNav();
            updateProgress();
            saveState();
        });
    });
    
    document.querySelectorAll('input[data-text]').forEach(inp => {
        inp.addEventListener('input', () => {
            state.answers[q.id] = inp.value || undefined;
            updateQuestionNav();
            updateProgress();
            saveState();
        });
    });
}

function startTimer() {
    if (timerInterval) clearInterval(timerInterval);
    
    timerInterval = setInterval(() => {
        state.timeRemaining--;
        
        const timerEl = document.getElementById('timer');
        timerEl.textContent = formatTime(state.timeRemaining);
        
        timerEl.classList.remove('warning', 'danger');
        if (state.timeRemaining <= 300) timerEl.classList.add('warning');
        if (state.timeRemaining <= 60) timerEl.classList.add('danger');
        
        if (state.timeRemaining <= 0) {
            submitQuiz();
        }
        
        saveState();
    }, 1000);
}

function submitQuiz() {
    if (timerInterval) clearInterval(timerInterval);
    
    state.submitted = true;
    state.elapsed = (CONFIG.TEST_DURATION * 60) - state.timeRemaining;
    
    gradeAll();
    generateSubmissionCode();
    saveState();
    
    showFeedbackScreen();
}

function generateSubmissionCode() {
    const data = {
        v: CONFIG.VERSION,
        n: state.niveau,
        s: state.seat,
        t: state.elapsed,
        p: state.totalEarned,
        m: CONFIG.LEVELS[state.niveau].totalPoints,
        a: state.answers
    };
    
    try {
        state.submissionCode = LZString.compressToEncodedURIComponent(JSON.stringify(data));
    } catch (e) {
        state.submissionCode = btoa(JSON.stringify(data));
    }
}

// ============================================================
// FEEDBACK SCREEN
// ============================================================
function showFeedbackScreen() {
    showScreen('feedbackScreen');
    
    const levelInfo = CONFIG.LEVELS[state.niveau];
    const totalPoints = levelInfo.totalPoints;
    const percent = Math.round((state.totalEarned / totalPoints) * 1000) / 10;
    const grade = calculateGrade(percent, totalPoints);
    
    document.getElementById('gradeDisplay').textContent = `${grade} NP`;
    document.getElementById('pointsDisplay').textContent = `${state.totalEarned} / ${totalPoints} Punkte (${percent}%)`;
    document.getElementById('seatDisplay').textContent = `Platz: ${state.seat}`;
    document.getElementById('dateDisplay').textContent = new Date().toLocaleDateString('de-DE');
    document.getElementById('timeDisplay').textContent = `Bearbeitungszeit: ${formatTime(state.elapsed)} von ${CONFIG.TEST_DURATION}:00`;
    
    // QR Code
    const qrContainer = document.getElementById('feedbackQR');
    qrContainer.innerHTML = '';
    if (state.submissionCode) {
        new QRCode(qrContainer, {
            text: state.submissionCode,
            width: 150,
            height: 150,
            correctLevel: QRCode.CorrectLevel.L
        });
        document.getElementById('submissionCodeDisplay').textContent = state.submissionCode;
    }
    
    // Points Summary
    renderPointsSummary();
    
    // Feedback Questions
    renderFeedbackQuestions();
}

function renderPointsSummary() {
    const container = document.getElementById('pointsSummary');
    const levelInfo = CONFIG.LEVELS[state.niveau];
    
    // Group by blocks (every 3-4 questions)
    const blocks = [];
    let currentBlock = { name: 'Block 1', points: 0, max: 0, questions: [] };
    
    state.gradedAnswers.forEach((ga, i) => {
        currentBlock.points += ga.earned;
        currentBlock.max += ga.max;
        currentBlock.questions.push(ga.id);
        
        if ((i + 1) % 4 === 0 || i === state.gradedAnswers.length - 1) {
            blocks.push(currentBlock);
            currentBlock = { name: `Block ${blocks.length + 1}`, points: 0, max: 0, questions: [] };
        }
    });
    
    let html = '<h3 style="margin-bottom: 15px;">üìä Punkte√ºbersicht</h3>';
    blocks.forEach((b, i) => {
        html += `<div class="points-row"><span>Block ${i + 1} (${b.questions.join(', ')})</span><span>${b.points} / ${b.max} P</span></div>`;
    });
    html += `<div class="points-row total"><span>GESAMT</span><span>${state.totalEarned} / ${levelInfo.totalPoints} P</span></div>`;
    
    container.innerHTML = html;
}

function renderFeedbackQuestions() {
    const container = document.getElementById('feedbackQuestions');
    let html = '';
    
    state.gradedAnswers.forEach((ga, i) => {
        const q = ga.question;
        const statusClass = ga.earned === ga.max ? 'correct' : (ga.earned > 0 ? 'partial' : 'wrong');
        const statusIcon = ga.earned === ga.max ? '‚úÖ' : (ga.earned > 0 ? '‚ö†Ô∏è' : '‚ùå');
        
        html += `
            <div class="feedback-question">
                <div class="feedback-question-header ${statusClass}">
                    <span>${statusIcon} Frage ${i + 1} (${ga.id})</span>
                    <span>${ga.earned} / ${ga.max} P</span>
                </div>
                <div class="feedback-question-body">
                    <div class="question-text">${q.text}</div>
                    ${q.svg ? `<div class="circuit-container">${q.svg}</div>` : ''}
                    ${renderFeedbackAnswer(q, ga)}
                </div>
            </div>
        `;
    });
    
    container.innerHTML = html;
}

function renderFeedbackAnswer(q, ga) {
    let html = '';
    const answer = ga.answer;
    
    if (q.type === 'mc') {
        const letters = ['A', 'B', 'C', 'D'];
        const givenLetter = answer !== undefined ? letters[answer] : '‚Äì';
        const correctLetter = letters[q.correct];
        
        html += `<div class="your-answer"><strong>Deine Antwort:</strong> ${givenLetter}) ${answer !== undefined ? q.options[answer] : 'keine'}</div>`;
        if (answer !== q.correct) {
            html += `<div class="correct-answer"><strong>Richtig:</strong> ${correctLetter}) ${q.options[q.correct]}</div>`;
        }
    } else if (q.type === 'multicheck') {
        const selected = answer || [];
        const givenStr = selected.map(i => q.options[i].text).join('; ') || 'keine';
        const correctStr = q.options.filter(o => o.correct).map(o => o.text).join('; ');
        
        html += `<div class="your-answer"><strong>Deine Antwort:</strong> ${givenStr}</div>`;
        html += `<div class="correct-answer"><strong>Richtig:</strong> ${correctStr}</div>`;
    } else if (q.type === 'dropdown') {
        let givenStr = '';
        let correctStr = '';
        q.dropdowns.forEach(d => {
            const given = answer && answer[d.id] || '‚Äì';
            givenStr += `${d.label} ${given}; `;
            correctStr += `${d.label} ${d.correct}; `;
        });
        
        html += `<div class="your-answer"><strong>Deine Antwort:</strong> ${givenStr}</div>`;
        html += `<div class="correct-answer"><strong>Richtig:</strong> ${correctStr}</div>`;
    } else if (q.type === 'number') {
        if (q.multiAnswer && q.answers) {
            let givenStr = '';
            let correctStr = '';
            q.answers.forEach((a, i) => {
                const given = answer && answer[i] || '‚Äì';
                givenStr += `${a.label} = ${given} ${q.unit}; `;
                correctStr += `${a.label} = ${a.correct.value} ${q.unit}; `;
            });
            html += `<div class="your-answer"><strong>Deine Antwort:</strong> ${givenStr}</div>`;
            html += `<div class="correct-answer"><strong>Richtig:</strong> ${correctStr}</div>`;
        } else {
            const given = answer || '‚Äì';
            html += `<div class="your-answer"><strong>Deine Antwort:</strong> ${given} ${q.unit || ''}</div>`;
            html += `<div class="correct-answer"><strong>Richtig:</strong> ${q.correct.value} ${q.unit || ''}</div>`;
        }
        if (q.solution) {
            html += `<div class="correct-answer" style="margin-top: 5px;"><strong>L√∂sungsweg:</strong> ${q.solution}</div>`;
        }
    } else if (q.type === 'text') {
        if (q.fields) {
            let givenStr = '';
            let correctStr = '';
            q.fields.forEach(f => {
                const given = answer && answer[f.id] || '‚Äì';
                givenStr += `${f.label} ${given}; `;
                correctStr += `${f.label} ${f.correct[0]}; `;
            });
            html += `<div class="your-answer"><strong>Deine Antwort:</strong> ${givenStr}</div>`;
            html += `<div class="correct-answer"><strong>Richtig:</strong> ${correctStr}</div>`;
        } else {
            const given = answer || '‚Äì';
            html += `<div class="your-answer"><strong>Deine Antwort:</strong> ${given}</div>`;
            html += `<div class="correct-answer"><strong>Richtig:</strong> ${q.correct[0]}</div>`;
        }
        if (q.solution) {
            html += `<div class="correct-answer" style="margin-top: 5px;"><strong>Erkl√§rung:</strong> ${q.solution}</div>`;
        }
    }
    
    return html;
}

function copyCode() {
    if (state.submissionCode) {
        navigator.clipboard.writeText(state.submissionCode).then(() => {
            alert('Code kopiert!');
        }).catch(() => {
            // Fallback
            const el = document.getElementById('submissionCodeDisplay');
            const range = document.createRange();
            range.selectNodeContents(el);
            window.getSelection().removeAllRanges();
            window.getSelection().addRange(range);
            document.execCommand('copy');
            alert('Code kopiert!');
        });
    }
}

// ============================================================
// INITIALISIERUNG
// ============================================================
function init() {
    // Seats generieren
    const seatGrid = document.getElementById('seatGrid');
    let seatHtml = '';
    for (let i = 1; i <= 30; i++) {
        const num = i.toString().padStart(2, '0');
        seatHtml += `<button class="seat-btn" data-seat="P${num}">P${num}</button>`;
    }
    seatGrid.innerHTML = seatHtml;
    
    // Event Listeners
    document.querySelectorAll('.level-btn').forEach(btn => {
        btn.addEventListener('click', () => {
            document.querySelectorAll('.level-btn').forEach(b => b.classList.remove('selected'));
            btn.classList.add('selected');
            state.niveau = btn.dataset.level;
            checkStartButton();
            
            // Check for saved state
            const saved = loadState(state.niveau);
            if (saved && saved.submitted) {
                if (confirm('Es gibt bereits eine abgegebene Arbeit f√ºr dieses Niveau. Fortsetzen?')) {
                    restoreSubmittedState(saved);
                    showFeedbackScreen();
                }
            } else if (saved && saved.startTime) {
                if (confirm('Es gibt einen laufenden Test f√ºr dieses Niveau. Fortsetzen?')) {
                    restoreQuizState(saved);
                }
            }
        });
    });
    
    document.querySelectorAll('.seat-btn').forEach(btn => {
        btn.addEventListener('click', () => {
            document.querySelectorAll('.seat-btn').forEach(b => b.classList.remove('selected'));
            btn.classList.add('selected');
            state.seat = btn.dataset.seat;
            checkStartButton();
        });
    });
    
    document.getElementById('startBtn').addEventListener('click', startQuiz);
    
    document.getElementById('prevBtn').addEventListener('click', () => {
        if (state.currentIndex > 0) {
            state.currentIndex--;
            renderCurrentQuestion();
            updateQuestionNav();
            saveState();
        }
    });
    
    document.getElementById('nextBtn').addEventListener('click', () => {
        if (state.currentIndex < state.questions.length - 1) {
            state.currentIndex++;
            renderCurrentQuestion();
            updateQuestionNav();
            saveState();
        } else {
            // Last question - submit
            if (confirm('Quiz jetzt abgeben? Du kannst danach keine √Ñnderungen mehr vornehmen.')) {
                submitQuiz();
            }
        }
    });
    
    document.querySelectorAll('.nav-btn').forEach(btn => {
        btn.addEventListener('click', () => {
            state.currentIndex = parseInt(btn.dataset.index);
            renderCurrentQuestion();
            updateQuestionNav();
            saveState();
        });
    });
    
    document.getElementById('questionNav').addEventListener('click', (e) => {
        if (e.target.classList.contains('nav-btn')) {
            state.currentIndex = parseInt(e.target.dataset.index);
            renderCurrentQuestion();
            updateQuestionNav();
            saveState();
        }
    });
    
    document.getElementById('resetBtn').addEventListener('click', () => {
        const code = prompt('Lehrer-Code eingeben:');
        if (code === CONFIG.RESET_CODE) {
            if (confirm('Quiz wirklich zur√ºcksetzen? Alle Daten werden gel√∂scht.')) {
                clearState();
                location.reload();
            }
        } else if (code) {
            alert('Falscher Code!');
        }
    });
}

function checkStartButton() {
    const startBtn = document.getElementById('startBtn');
    startBtn.disabled = !(state.niveau && state.seat);
}

function restoreQuizState(saved) {
    state.niveau = saved.niveau;
    state.seat = saved.seat;
    state.answers = saved.answers || {};
    state.startTime = saved.startTime;
    state.timeRemaining = saved.timeRemaining;
    state.currentIndex = saved.currentIndex || 0;
    state.questions = QUESTIONS[state.niveau];
    
    const levelInfo = CONFIG.LEVELS[state.niveau];
    document.getElementById('levelBadge').textContent = `${levelInfo.symbol} ${levelInfo.name}`;
    
    showScreen('quizScreen');
    renderCurrentQuestion();
    updateQuestionNav();
    updateProgress();
    startTimer();
}

function restoreSubmittedState(saved) {
    state.niveau = saved.niveau;
    state.seat = saved.seat;
    state.answers = saved.answers || {};
    state.submitted = true;
    state.submissionCode = saved.submissionCode;
    state.gradedAnswers = saved.gradedAnswers || [];
    state.totalEarned = saved.totalEarned || 0;
    state.elapsed = saved.elapsed || 0;
    state.questions = QUESTIONS[state.niveau];
    
    // Re-grade if needed
    if (!state.gradedAnswers.length) {
        gradeAll();
        generateSubmissionCode();
        saveState();
    }
}

// Start
document.addEventListener('DOMContentLoaded', init);
</script>
</body>
</html>
