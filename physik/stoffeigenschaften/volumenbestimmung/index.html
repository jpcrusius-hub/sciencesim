<!DOCTYPE html>
<html lang="de">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Volumenbestimmung unregelm√§√üiger K√∂rper ‚Äì Simulation</title>
    <meta name="subject" content="Physik">
    <meta name="topic" content="Stoffeigenschaften">
    <meta name="grade" content="6">
    <meta name="description" content="Interaktive Simulation zur Volumenbestimmung unregelm√§√üiger K√∂rper mit Differenz- und √úberlaufmethode">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: #f5f5f5;
            min-height: 100vh;
            padding: 10px;
        }
        
        .breadcrumb {
            max-width: 900px;
            margin: 0 auto 10px auto;
            font-size: 13px;
            color: #666;
        }
        
        .breadcrumb a {
            color: #0066cc;
            text-decoration: none;
        }
        
        .breadcrumb a:hover {
            text-decoration: underline;
        }
        
        .container {
            max-width: 900px;
            margin: 0 auto;
            background: white;
            border-radius: 3px;
            border: 1px solid #ddd;
            overflow: hidden;
        }
        
        /* Tabs */
        .tabs {
            display: flex;
            background: #2c5aa0;
        }
        
        .tab {
            flex: 1;
            padding: 16px 20px;
            text-align: center;
            color: white;
            font-weight: 600;
            font-size: 16px;
            cursor: pointer;
            transition: background 0.2s;
            border: none;
            background: transparent;
        }
        
        .tab:hover {
            background: rgba(255,255,255,0.1);
        }
        
        .tab.active {
            background: #1e4a8a;
        }
        
        .tab-content {
            display: none;
            padding: 20px;
        }
        
        .tab-content.active {
            display: block;
        }
        
        /* Main Layout */
        .simulation-area {
            display: grid;
            grid-template-columns: 160px 1fr 220px;
            gap: 20px;
            min-height: 450px;
        }
        
        /* K√∂rperauswahl */
        .body-selection {
            background: #f8fafc;
            border-radius: 3px;
            padding: 15px;
        }
        
        .body-selection h3 {
            font-size: 14px;
            color: #475569;
            margin-bottom: 12px;
            text-align: center;
        }
        
        .body-btn {
            width: 100%;
            padding: 12px 10px;
            margin-bottom: 8px;
            border: 2px solid #e2e8f0;
            border-radius: 3px;
            background: white;
            cursor: pointer;
            transition: all 0.2s;
            font-size: 13px;
            text-align: left;
        }
        
        .body-btn:hover {
            border-color: #2c5aa0;
            background: #eff6ff;
        }
        
        .body-btn.immersed {
            border-color: #16a34a;
            background: #dcfce7;
        }
        
        .body-btn .icon {
            font-size: 18px;
            margin-right: 5px;
        }
        
        .body-btn .volume {
            font-size: 11px;
            color: #64748b;
            display: block;
            margin-top: 2px;
        }
        
        .body-btn.immersed .volume {
            color: #16a34a;
        }
        
        .hint-text {
            font-size: 11px;
            color: #64748b;
            text-align: center;
            margin-top: 10px;
            padding: 8px;
            background: #fef3c7;
            border-radius: 3px;
        }
        
        /* Messzylinder-Bereich */
        .cylinder-area {
            display: flex;
            justify-content: center;
            align-items: flex-end;
            padding: 20px;
            position: relative;
        }
        
        .cylinder-container {
            position: relative;
        }
        
        /* SVG Messzylinder */
        .cylinder-svg {
            display: block;
        }
        
        /* Eingabe-Bereich */
        .input-area {
            background: #f8fafc;
            border-radius: 3px;
            padding: 15px;
        }
        
        .input-area h3 {
            font-size: 14px;
            color: #475569;
            margin-bottom: 15px;
            text-align: center;
        }
        
        .input-group {
            margin-bottom: 12px;
        }
        
        .input-group label {
            display: block;
            font-size: 13px;
            color: #334155;
            margin-bottom: 4px;
        }
        
        .input-group input {
            width: 100%;
            padding: 10px;
            border: 2px solid #e2e8f0;
            border-radius: 3px;
            font-size: 16px;
            text-align: center;
        }
        
        .input-group input:focus {
            outline: none;
            border-color: #2c5aa0;
        }
        
        .input-group.result {
            background: #fef3c7;
            padding: 10px;
            border-radius: 3px;
            margin-top: 15px;
        }
        
        .input-group.result label {
            font-weight: 600;
            color: #92400e;
        }
        
        .input-group.result input {
            background: white;
            border-color: #f59e0b;
            font-weight: 600;
        }
        
        .divider {
            height: 2px;
            background: #cbd5e1;
            margin: 10px 0;
        }
        
        /* Buttons */
        .action-btn {
            width: 100%;
            padding: 12px;
            border: none;
            border-radius: 3px;
            font-size: 14px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.2s;
            margin-top: 8px;
        }
        
        .action-btn.secondary {
            background: #e2e8f0;
            color: #475569;
        }
        
        .action-btn.secondary:hover {
            background: #cbd5e1;
        }
        
        .action-btn.success {
            background: #16a34a;
            color: white;
        }
        
        .action-btn.success:hover {
            background: #15803d;
        }
        
        /* Feedback */
        .feedback {
            text-align: center;
            padding: 10px;
            border-radius: 3px;
            margin-top: 10px;
            font-weight: 600;
            display: none;
        }
        
        .feedback.correct {
            display: block;
            background: #dcfce7;
            color: #166534;
        }
        
        .feedback.incorrect {
            display: block;
            background: #fee2e2;
            color: #991b1b;
        }
        
        /* Info-Box Ablesen */
        .info-box {
            background: #fefce8;
            border: 1px solid #fde047;
            border-radius: 3px;
            padding: 10px;
            margin-top: 15px;
            font-size: 12px;
        }
        
        .info-box h4 {
            color: #854d0e;
            font-size: 12px;
            margin-bottom: 5px;
        }
        
        .info-box p {
            color: #713f12;
            line-height: 1.4;
        }
        
        /* Anleitung */
        .instructions {
            background: #eff6ff;
            border: 1px solid #bfdbfe;
            border-radius: 3px;
            padding: 12px 15px;
            margin-top: 15px;
        }
        
        .instructions h4 {
            font-size: 13px;
            color: #2c5aa0;
            margin-bottom: 8px;
        }
        
        .instructions ol {
            font-size: 13px;
            color: #334155;
            padding-left: 20px;
        }
        
        .instructions li {
            margin-bottom: 4px;
        }
        
        /* √úberlaufmethode */
        .overflow-area {
            display: flex;
            flex-direction: column;
            justify-content: flex-start;
            align-items: center;
            gap: 0;
        }
        
        .overflow-container {
            text-align: center;
        }
        
        /* K√∂rper Animation */
        @keyframes sink {
            0% { transform: translateY(-50px); opacity: 0; }
            100% { transform: translateY(0); opacity: 1; }
        }
        
        .body-in-water {
            animation: sink 0.5s ease-out;
        }
        
        /* Responsive */
        @media (max-width: 800px) {
            .simulation-area {
                grid-template-columns: 1fr;
            }
            
            .body-selection {
                display: flex;
                gap: 10px;
                flex-wrap: wrap;
            }
            
            .body-selection h3 {
                width: 100%;
            }
            
            .body-btn {
                flex: 1;
                min-width: 100px;
            }
        }
        
    </style>
</head>
<body>
    <p class="breadcrumb"><a href="../../../">‚Üê √úbersicht</a> ¬∑ Physik ¬∑ Stoffeigenschaften</p>
    <header style="max-width: 900px; margin: 0 auto 15px auto;">
        <h1 style="font-size: 1.4em; font-weight: 600; color: #222; margin: 0;">Volumenbestimmung unregelm√§√üiger K√∂rper</h1>
    </header>
    <div class="container">
        <!-- Tabs -->
        <div class="tabs">
            <button class="tab active" onclick="switchTab('differenz')">Differenzmethode</button>
            <button class="tab" onclick="switchTab('√ºberlauf')">√úberlaufmethode</button>
        </div>
        
        <!-- Differenzmethode -->
        <div id="differenz" class="tab-content active">
            <div class="simulation-area">
                <!-- K√∂rperauswahl -->
                <div class="body-selection">
                    <h3>K√∂rper anklicken:</h3>
                    <button class="body-btn" id="btn-murmel" onclick="toggleBody('murmel')">
                        <span class="icon">üîµ</span> Murmel
                        <span class="volume">V = ? ml</span>
                    </button>
                    <button class="body-btn" id="btn-w√ºrfel" onclick="toggleBody('w√ºrfel')">
                        <span class="icon">üü´</span> W√ºrfel
                        <span class="volume">V = ? ml</span>
                    </button>
                    <button class="body-btn" id="btn-kugel" onclick="toggleBody('kugel')">
                        <span class="icon">üü†</span> Kugel
                        <span class="volume">V = ? ml</span>
                    </button>
                    <button class="body-btn" id="btn-stein" onclick="toggleBody('stein')">
                        <span class="icon">ü™®</span> Stein
                        <span class="volume">V = ? ml</span>
                    </button>
                    <div class="hint-text">
                        Klicken = eintauchen<br>
                        Nochmal klicken = herausnehmen
                    </div>
                </div>
                
                <!-- Messzylinder -->
                <div class="cylinder-area">
                    <div class="cylinder-container">
                        <svg id="cylinder-diff" class="cylinder-svg" width="200" height="400" viewBox="0 0 200 400">
                            <defs>
                                <linearGradient id="glassGradient" x1="0%" y1="0%" x2="100%" y2="0%">
                                    <stop offset="0%" style="stop-color:#d1d5db;stop-opacity:0.4" />
                                    <stop offset="50%" style="stop-color:#ffffff;stop-opacity:0.2" />
                                    <stop offset="100%" style="stop-color:#d1d5db;stop-opacity:0.4" />
                                </linearGradient>
                                <linearGradient id="waterGradient" x1="0%" y1="0%" x2="100%" y2="0%">
                                    <stop offset="0%" style="stop-color:#60a5fa;stop-opacity:0.85" />
                                    <stop offset="50%" style="stop-color:#93c5fd;stop-opacity:0.75" />
                                    <stop offset="100%" style="stop-color:#60a5fa;stop-opacity:0.85" />
                                </linearGradient>
                            </defs>
                            
                            <!-- Zylinder Hintergrund -->
                            <rect x="60" y="30" width="80" height="330" fill="url(#glassGradient)" stroke="#9ca3af" stroke-width="2" rx="2"/>
                            
                            <!-- Boden Ellipse -->
                            <ellipse cx="100" cy="360" rx="40" ry="8" fill="#d1d5db" stroke="#9ca3af" stroke-width="2"/>
                            
                            <!-- Skala -->
                            <g id="scale-diff"></g>
                            
                            <!-- Wasser -->
                            <g id="water-diff"></g>
                            
                            <!-- K√∂rper im Wasser -->
                            <g id="bodies-diff"></g>
                            
                            <!-- Ableselinie -->
                            <line id="readLine-diff" x1="40" y1="0" x2="160" y2="0" stroke="#ef4444" stroke-width="2" stroke-dasharray="6,4" visibility="hidden"/>
                            
                            <!-- Einheit -->
                            <text x="100" y="20" text-anchor="middle" font-size="14" fill="#374151" font-weight="600">ml</text>
                        </svg>
                    </div>
                </div>
                
                <!-- Eingaben -->
                <div class="input-area">
                    <h3>Messwerte eintragen:</h3>
                    
                    <div class="input-group">
                        <label>V‚ÇÅ (Startvolumen):</label>
                        <input type="number" id="v1-input" placeholder="? ml" step="0.5" min="0" max="50">
                    </div>
                    
                    <div class="input-group">
                        <label>V‚ÇÇ (nach Eintauchen):</label>
                        <input type="number" id="v2-input" placeholder="? ml" step="0.5" min="0" max="60">
                    </div>
                    
                    <div class="divider"></div>
                    
                    <div class="input-group result">
                        <label>V<sub>K√∂rper</sub> = V‚ÇÇ ‚àí V‚ÇÅ =</label>
                        <input type="number" id="result-input" placeholder="? ml" step="0.5" min="0">
                    </div>
                    
                    <button class="action-btn success" id="btn-check" onclick="checkResult()">
                        ‚úì Ergebnis pr√ºfen
                    </button>
                    
                    <button class="action-btn secondary" onclick="resetDifferenz()">
                        üîÑ Neu starten
                    </button>
                    
                    <div id="feedback-diff" class="feedback"></div>
                    
                    <div class="info-box">
                        <h4>üí° Richtiges Ablesen:</h4>
                        <p>1. Unten am Meniskus ablesen<br>
                        2. Waagerecht auf Augenh√∂he schauen</p>
                    </div>
                </div>
            </div>
            
            <div class="instructions">
                <h4>Anleitung ‚Äì Differenzmethode:</h4>
                <ol>
                    <li>Lies den Wasserstand V‚ÇÅ ab (unten am Meniskus!)</li>
                    <li>Klicke auf einen oder mehrere K√∂rper zum Eintauchen</li>
                    <li>Lies den neuen Wasserstand V‚ÇÇ ab</li>
                    <li>Berechne: V<sub>K√∂rper</sub> = V‚ÇÇ ‚àí V‚ÇÅ</li>
                </ol>
            </div>
        </div>
        
        <!-- √úberlaufmethode -->
        <div id="√ºberlauf" class="tab-content">
            <div class="simulation-area">
                <!-- K√∂rperauswahl -->
                <div class="body-selection">
                    <h3>K√∂rper anklicken:</h3>
                    <button class="body-btn" id="btn-murmel-o" onclick="toggleBodyOverflow('murmel')">
                        <span class="icon">üîµ</span> Murmel
                        <span class="volume">V = ? ml</span>
                    </button>
                    <button class="body-btn" id="btn-w√ºrfel-o" onclick="toggleBodyOverflow('w√ºrfel')">
                        <span class="icon">üü´</span> W√ºrfel
                        <span class="volume">V = ? ml</span>
                    </button>
                    <button class="body-btn" id="btn-kugel-o" onclick="toggleBodyOverflow('kugel')">
                        <span class="icon">üü†</span> Kugel
                        <span class="volume">V = ? ml</span>
                    </button>
                    <button class="body-btn" id="btn-stein-o" onclick="toggleBodyOverflow('stein')">
                        <span class="icon">ü™®</span> Stein
                        <span class="volume">V = ? ml</span>
                    </button>
                    <div class="hint-text">
                        Klicken = eintauchen<br>
                        Nochmal klicken = herausnehmen
                    </div>
                </div>
                
                <!-- √úberlaufgef√§√ü und Auffangzylinder -->
                <div class="cylinder-area">
                    <div class="overflow-area">
                        <!-- Kombiniertes SVG: √úberlaufgef√§√ü mit schr√§ger T√ºlle + Messzylinder darunter -->
                        <div class="overflow-container">
                            <svg id="overflow-combined" class="cylinder-svg" width="220" height="420" viewBox="0 0 220 420">
                                <defs>
                                    <linearGradient id="waterGradientOV" x1="0%" y1="0%" x2="100%" y2="0%">
                                        <stop offset="0%" style="stop-color:#60a5fa;stop-opacity:0.85" />
                                        <stop offset="50%" style="stop-color:#93c5fd;stop-opacity:0.75" />
                                        <stop offset="100%" style="stop-color:#60a5fa;stop-opacity:0.85" />
                                    </linearGradient>
                                    <linearGradient id="waterGradientCatch" x1="0%" y1="0%" x2="100%" y2="0%">
                                        <stop offset="0%" style="stop-color:#60a5fa;stop-opacity:0.85" />
                                        <stop offset="50%" style="stop-color:#93c5fd;stop-opacity:0.75" />
                                        <stop offset="100%" style="stop-color:#60a5fa;stop-opacity:0.85" />
                                    </linearGradient>
                                </defs>
                                
                                <!-- ===== √úBERLAUFGEF√ÑSS (oben) ===== -->
                                <!-- Gef√§√ü Hintergrund (Becher) -->
                                <rect x="30" y="20" width="90" height="150" fill="url(#glassGradient)" stroke="#9ca3af" stroke-width="2" rx="2"/>
                                
                                <!-- Boden-Ellipse √úberlaufgef√§√ü -->
                                <ellipse cx="75" cy="170" rx="45" ry="8" fill="#d1d5db" stroke="#9ca3af" stroke-width="2"/>
                                
                                <!-- Schr√§ge T√ºlle (Umriss) -->
                                <path d="M120,70 L185,145 L185,160 L120,85" 
                                      fill="url(#glassGradient)" stroke="#9ca3af" stroke-width="2"/>
                                <!-- T√ºllenende -->
                                <line x1="185" y1="145" x2="185" y2="160" stroke="#9ca3af" stroke-width="2"/>
                                
                                <!-- Wasser im √úberlaufgef√§√ü (kombinierter Pfad mit Meniskus) -->
                                <!-- Meniskus: R√§nder bei y=72 (h√∂her), Mitte bei y=77 (tiefer) -->
                                <path d="M32,72 Q35,77 42,77 L108,77 Q115,77 118,72 L118,168 L32,168 Z" 
                                      fill="url(#waterGradientOV)"/>
                                
                                <!-- Meniskuslinie (schwarze Oberfl√§chenlinie) -->
                                <path d="M32,72 Q35,77 42,77 L108,77 Q115,77 118,72" 
                                      fill="none" stroke="#2c5aa0" stroke-width="2"/>
                                
                                <!-- Wasser in der T√ºlle (gef√ºllt) - Parallelogramm innerhalb der T√ºlle -->
                                <path d="M118,74 L180,147 L180,155 L118,82 Z" 
                                      fill="url(#waterGradientOV)"/>
                                
                                <!-- K√∂rper im √úberlaufgef√§√ü -->
                                <g id="bodies-overflow"></g>
                                
                                <!-- Wasserstrahl (senkrecht von T√ºlle) -->
                                <g id="overflow-stream" visibility="hidden">
                                    <line x1="183" y1="160" x2="183" y2="250" 
                                          stroke="#60a5fa" stroke-width="6" stroke-linecap="round" opacity="0.8"/>
                                </g>
                                
                                <text x="75" y="195" text-anchor="middle" font-size="11" fill="#64748b">√úberlaufgef√§√ü</text>
                                
                                <!-- ===== AUFFANG-MESSZYLINDER (unten, unter der T√ºlle) ===== -->
                                <!-- Messzylinder 25ml -->
                                <rect x="153" y="260" width="60" height="130" fill="url(#glassGradient)" stroke="#9ca3af" stroke-width="2" rx="2"/>
                                
                                <!-- Boden-Ellipse -->
                                <ellipse cx="183" cy="390" rx="30" ry="6" fill="#d1d5db" stroke="#9ca3af" stroke-width="2"/>
                                
                                <!-- Skala (wird dynamisch gezeichnet) -->
                                <g id="scale-overflow"></g>
                                
                                <!-- Aufgefangenes Wasser -->
                                <g id="water-catch"></g>
                                
                                <!-- Ableselinie -->
                                <line id="readLine-overflow" x1="130" y1="0" x2="220" y2="0" stroke="#ef4444" stroke-width="2" stroke-dasharray="6,4" visibility="hidden"/>
                                
                                <text x="183" y="250" text-anchor="middle" font-size="10" fill="#374151" font-weight="600">ml</text>
                                <text x="183" y="410" text-anchor="middle" font-size="11" fill="#64748b">Auffanggef√§√ü</text>
                            </svg>
                        </div>
                    </div>
                </div>
                
                <!-- Eingaben -->
                <div class="input-area">
                    <h3>Messwert eintragen:</h3>
                    
                    <div class="input-group result">
                        <label>V<sub>K√∂rper</sub> = aufgefangenes Wasser =</label>
                        <input type="number" id="result-overflow" placeholder="? ml" step="0.5" min="0">
                    </div>
                    
                    <button class="action-btn success" id="btn-check-overflow" onclick="checkResultOverflow()">
                        ‚úì Ergebnis pr√ºfen
                    </button>
                    
                    <button class="action-btn secondary" onclick="resetOverflow()">
                        üîÑ Neu starten
                    </button>
                    
                    <div id="feedback-overflow" class="feedback"></div>
                    
                    <div class="info-box">
                        <h4>üí° √úberlaufmethode:</h4>
                        <p>Das Gef√§√ü ist randvoll. Der eingetauchte K√∂rper verdr√§ngt genau sein Volumen ‚Äì es l√§uft √ºber!</p>
                    </div>
                </div>
            </div>
            
            <div class="instructions">
                <h4>Anleitung ‚Äì √úberlaufmethode:</h4>
                <ol>
                    <li>Das √úberlaufgef√§√ü ist randvoll mit Wasser</li>
                    <li>Klicke auf K√∂rper zum Eintauchen ‚Äì Wasser l√§uft √ºber</li>
                    <li>Lies das aufgefangene Wasser ab = Volumen des K√∂rpers</li>
                </ol>
            </div>
        </div>
    </div>
    
    <script>
        // ============================================
        // KONFIGURATION
        // ============================================
        const CONFIG = {
            // Differenzmethode - 50ml Zylinder
            maxVolume: 50,
            cylinderHeight: 330,
            cylinderTop: 30,
            cylinderX: 60,
            cylinderWidth: 80,
            cylinderBottom: 360,  // y-Position Boden
            pxPerMl: 6.6,
            
            // √úberlaufmethode - 25ml Auffangzylinder (unter der T√ºlle)
            overflowMaxVol: 25,
            overflowHeight: 130,
            overflowTop: 260,
            overflowX: 153,
            overflowWidth: 60,
            overflowBottom: 390,
            overflowPxPerMl: 5.2,
            
            // √úberlaufgef√§√ü-K√∂rperbereich
            ovVesselX: 32,
            ovVesselWidth: 86,
            ovVesselBottom: 165
        };
        
        // K√∂rper-Definitionen
        const BODIES = {
            murmel: { volume: 4, color: '#2c5aa0', stroke: '#2c5aa0', height: 20 },
            w√ºrfel: { volume: 8, color: '#78716c', stroke: '#44403c', height: 24 },
            kugel: { volume: 12, color: '#f97316', stroke: '#c2410c', height: 32 },
            stein: { volume: 18, color: '#a8a29e', stroke: '#57534e', height: 28 }
        };
        
        // ============================================
        // STATE
        // ============================================
        let state = {
            startVolume: 0,
            immersedBodies: new Set(),
            immersedBodiesOverflow: new Set()
        };
        
        // ============================================
        // INITIALISIERUNG
        // ============================================
        function init() {
            drawScale('scale-diff', CONFIG.maxVolume, CONFIG.pxPerMl, CONFIG.cylinderTop, CONFIG.cylinderX + CONFIG.cylinderWidth);
            drawScaleOverflow();
            resetDifferenz();
            resetOverflow();
        }
        
        // ============================================
        // SKALA ZEICHNEN - Differenzmethode (50ml)
        // ============================================
        function drawScale(containerId, maxVol, pxPerMl, topY, startX) {
            const container = document.getElementById(containerId);
            container.innerHTML = '';
            
            for (let ml = 0; ml <= maxVol; ml++) {
                const y = topY + (maxVol - ml) * pxPerMl;
                
                let lineLength, strokeWidth;
                
                if (ml % 10 === 0) {
                    lineLength = 15;
                    strokeWidth = 2;
                    
                    const text = document.createElementNS('http://www.w3.org/2000/svg', 'text');
                    text.setAttribute('x', startX + 18);
                    text.setAttribute('y', y + 4);
                    text.setAttribute('font-size', '12');
                    text.setAttribute('fill', '#374151');
                    text.textContent = ml;
                    container.appendChild(text);
                } else if (ml % 5 === 0) {
                    lineLength = 10;
                    strokeWidth = 1.5;
                } else {
                    lineLength = 6;
                    strokeWidth = 1;
                }
                
                const line = document.createElementNS('http://www.w3.org/2000/svg', 'line');
                line.setAttribute('x1', startX);
                line.setAttribute('y1', y);
                line.setAttribute('x2', startX + lineLength);
                line.setAttribute('y2', y);
                line.setAttribute('stroke', '#6b7280');
                line.setAttribute('stroke-width', strokeWidth);
                container.appendChild(line);
            }
        }
        
        // ============================================
        // SKALA ZEICHNEN - √úberlaufmethode (25ml)
        // ============================================
        function drawScaleOverflow() {
            const container = document.getElementById('scale-overflow');
            container.innerHTML = '';
            
            const maxVol = CONFIG.overflowMaxVol;
            const pxPerMl = CONFIG.overflowPxPerMl;
            const topY = CONFIG.overflowTop;
            // Skala LINKS vom Zylinder zeichnen
            const endX = CONFIG.overflowX;  // Linke Kante des Zylinders
            
            for (let ml = 0; ml <= maxVol; ml++) {
                const y = topY + (maxVol - ml) * pxPerMl;
                
                let lineLength, strokeWidth;
                
                if (ml % 5 === 0) {
                    lineLength = 12;
                    strokeWidth = 2;
                    
                    const text = document.createElementNS('http://www.w3.org/2000/svg', 'text');
                    text.setAttribute('x', endX - 16);
                    text.setAttribute('y', y + 4);
                    text.setAttribute('font-size', '11');
                    text.setAttribute('fill', '#374151');
                    text.setAttribute('text-anchor', 'end');
                    text.textContent = ml;
                    container.appendChild(text);
                } else {
                    lineLength = 6;
                    strokeWidth = 1;
                }
                
                const line = document.createElementNS('http://www.w3.org/2000/svg', 'line');
                line.setAttribute('x1', endX - lineLength);
                line.setAttribute('y1', y);
                line.setAttribute('x2', endX);
                line.setAttribute('y2', y);
                line.setAttribute('stroke', '#6b7280');
                line.setAttribute('stroke-width', strokeWidth);
                container.appendChild(line);
            }
        }
        
        // ============================================
        // WASSER MIT KORREKTEM MENISKUS ZEICHNEN
        // ============================================
        function drawWater(containerId, volume, config, gradientId) {
            const container = document.getElementById(containerId);
            container.innerHTML = '';
            
            if (volume <= 0) return;
            
            const { maxVol, pxPerMl, topY, x, width } = config;
            
            const bottomY = topY + maxVol * pxPerMl;
            const waterHeight = volume * pxPerMl;
            const waterBaseY = bottomY - waterHeight;
            
            const meniscusRise = 6;
            const edgeY = waterBaseY - meniscusRise;
            const centerY = waterBaseY;
            
            // Wasserk√∂rper
            const path = document.createElementNS('http://www.w3.org/2000/svg', 'path');
            const pathD = `
                M ${x + 3} ${edgeY}
                Q ${x + 3} ${centerY + 2} ${x + 12} ${centerY}
                L ${x + width - 12} ${centerY}
                Q ${x + width - 3} ${centerY + 2} ${x + width - 3} ${edgeY}
                L ${x + width - 3} ${bottomY - 3}
                L ${x + 3} ${bottomY - 3}
                Z
            `;
            path.setAttribute('d', pathD);
            path.setAttribute('fill', `url(#${gradientId})`);
            container.appendChild(path);
            
            // Meniskus-Linie
            const meniscusLine = document.createElementNS('http://www.w3.org/2000/svg', 'path');
            meniscusLine.setAttribute('d', `
                M ${x + 3} ${edgeY}
                Q ${x + 3} ${centerY + 2} ${x + 12} ${centerY}
                L ${x + width - 12} ${centerY}
                Q ${x + width - 3} ${centerY + 2} ${x + width - 3} ${edgeY}
            `);
            meniscusLine.setAttribute('fill', 'none');
            meniscusLine.setAttribute('stroke', '#2c5aa0');
            meniscusLine.setAttribute('stroke-width', '2.5');
            container.appendChild(meniscusLine);
        }
        
        // ============================================
        // ABLESELINIE POSITIONIEREN
        // ============================================
        function updateReadLine(lineId, volume, config) {
            const line = document.getElementById(lineId);
            const { maxVol, pxPerMl, topY } = config;
            
            const bottomY = topY + maxVol * pxPerMl;
            const waterBaseY = bottomY - volume * pxPerMl;
            
            line.setAttribute('y1', waterBaseY);
            line.setAttribute('y2', waterBaseY);
            line.setAttribute('visibility', 'visible');
        }
        
        // ============================================
        // K√ñRPER AM BODEN DES ZYLINDERS ZEICHNEN
        // ============================================
        function drawBodies(containerId, bodies, bottomY, cx) {
            const container = document.getElementById(containerId);
            container.innerHTML = '';
            
            // K√∂rper von unten nach oben stapeln
            let currentY = bottomY - 5;  // Etwas √ºber dem Boden starten
            
            bodies.forEach(bodyType => {
                const body = BODIES[bodyType];
                
                let shape;
                
                switch(bodyType) {
                    case 'murmel':
                        currentY -= 10;  // Radius
                        shape = document.createElementNS('http://www.w3.org/2000/svg', 'circle');
                        shape.setAttribute('cx', cx);
                        shape.setAttribute('cy', currentY);
                        shape.setAttribute('r', 10);
                        currentY -= 12;  // Platz f√ºr n√§chsten K√∂rper
                        break;
                        
                    case 'w√ºrfel':
                        currentY -= 24;  // H√∂he
                        shape = document.createElementNS('http://www.w3.org/2000/svg', 'rect');
                        shape.setAttribute('x', cx - 12);
                        shape.setAttribute('y', currentY);
                        shape.setAttribute('width', 24);
                        shape.setAttribute('height', 24);
                        shape.setAttribute('rx', '2');
                        currentY -= 5;
                        break;
                        
                    case 'kugel':
                        currentY -= 16;  // Radius
                        shape = document.createElementNS('http://www.w3.org/2000/svg', 'circle');
                        shape.setAttribute('cx', cx);
                        shape.setAttribute('cy', currentY);
                        shape.setAttribute('r', 16);
                        currentY -= 18;
                        break;
                        
                    case 'stein':
                        currentY -= 14;  // Halbe H√∂he
                        shape = document.createElementNS('http://www.w3.org/2000/svg', 'path');
                        const y = currentY;
                        shape.setAttribute('d', `
                            M ${cx-15} ${y+4} 
                            Q ${cx-17} ${y-8} ${cx-4} ${y-12}
                            Q ${cx+8} ${y-14} ${cx+15} ${y-4}
                            Q ${cx+17} ${y+8} ${cx+4} ${y+12}
                            Q ${cx-8} ${y+14} ${cx-15} ${y+4} Z
                        `);
                        currentY -= 16;
                        break;
                }
                
                if (shape) {
                    shape.setAttribute('fill', body.color);
                    shape.setAttribute('stroke', body.stroke);
                    shape.setAttribute('stroke-width', '2');
                    shape.classList.add('body-in-water');
                    container.appendChild(shape);
                }
            });
        }
        
        // ============================================
        // TAB-WECHSEL
        // ============================================
        function switchTab(tabId) {
            document.querySelectorAll('.tab').forEach(t => t.classList.remove('active'));
            document.querySelectorAll('.tab-content').forEach(c => c.classList.remove('active'));
            
            document.querySelector(`.tab-content#${tabId}`).classList.add('active');
            event.target.classList.add('active');
        }
        
        // ============================================
        // DIFFERENZMETHODE
        // ============================================
        function toggleBody(bodyType) {
            const btn = document.getElementById(`btn-${bodyType}`);
            
            if (state.immersedBodies.has(bodyType)) {
                state.immersedBodies.delete(bodyType);
                btn.classList.remove('immersed');
            } else {
                state.immersedBodies.add(bodyType);
                btn.classList.add('immersed');
            }
            
            updateDifferenzDisplay();
        }
        
        function updateDifferenzDisplay() {
            let totalBodyVolume = 0;
            state.immersedBodies.forEach(bodyType => {
                totalBodyVolume += BODIES[bodyType].volume;
            });
            
            const currentVolume = state.startVolume + totalBodyVolume;
            
            const config = {
                maxVol: CONFIG.maxVolume,
                pxPerMl: CONFIG.pxPerMl,
                topY: CONFIG.cylinderTop,
                x: CONFIG.cylinderX,
                width: CONFIG.cylinderWidth
            };
            
            drawWater('water-diff', currentVolume, config, 'waterGradient');
            updateReadLine('readLine-diff', currentVolume, config);
            
            // K√∂rper am Boden des Zylinders zeichnen
            drawBodies('bodies-diff', Array.from(state.immersedBodies), CONFIG.cylinderBottom - 8, 100);
        }
        
        function checkResult() {
            const v1 = parseFloat(document.getElementById('v1-input').value);
            const v2 = parseFloat(document.getElementById('v2-input').value);
            const result = parseFloat(document.getElementById('result-input').value);
            
            let actualVolume = 0;
            state.immersedBodies.forEach(bodyType => {
                actualVolume += BODIES[bodyType].volume;
            });
            
            const actualV2 = state.startVolume + actualVolume;
            
            const feedback = document.getElementById('feedback-diff');
            
            const v1Correct = Math.abs(v1 - state.startVolume) <= 0.5;
            const v2Correct = Math.abs(v2 - actualV2) <= 0.5;
            const resultCorrect = Math.abs(result - actualVolume) <= 0.5;
            
            if (v1Correct && v2Correct && resultCorrect) {
                feedback.className = 'feedback correct';
                feedback.innerHTML = `‚úì Richtig! V‚ÇÅ = ${state.startVolume} ml, V‚ÇÇ = ${actualV2} ml<br>V<sub>K√∂rper</sub> = ${actualVolume} ml`;
            } else {
                let hint = '‚úó √úberpr√ºfe: ';
                if (!v1Correct) hint += `V‚ÇÅ = ${state.startVolume} ml. `;
                if (!v2Correct) hint += `V‚ÇÇ = ${actualV2} ml. `;
                if (!resultCorrect) hint += `V = ${actualV2} - ${state.startVolume} = ${actualVolume} ml.`;
                feedback.className = 'feedback incorrect';
                feedback.innerHTML = hint;
            }
        }
        
        function resetDifferenz() {
            const options = [20, 22, 24, 26, 28, 30, 32, 34];
            state.startVolume = options[Math.floor(Math.random() * options.length)];
            state.immersedBodies.clear();
            
            document.querySelectorAll('#differenz .body-btn').forEach(btn => {
                btn.classList.remove('immersed');
            });
            
            document.getElementById('v1-input').value = '';
            document.getElementById('v2-input').value = '';
            document.getElementById('result-input').value = '';
            document.getElementById('feedback-diff').className = 'feedback';
            document.getElementById('feedback-diff').innerHTML = '';
            
            const config = {
                maxVol: CONFIG.maxVolume,
                pxPerMl: CONFIG.pxPerMl,
                topY: CONFIG.cylinderTop,
                x: CONFIG.cylinderX,
                width: CONFIG.cylinderWidth
            };
            
            drawWater('water-diff', state.startVolume, config, 'waterGradient');
            updateReadLine('readLine-diff', state.startVolume, config);
            
            document.getElementById('bodies-diff').innerHTML = '';
        }
        
        // ============================================
        // √úBERLAUFMETHODE
        // ============================================
        function toggleBodyOverflow(bodyType) {
            const btn = document.getElementById(`btn-${bodyType}-o`);
            
            if (state.immersedBodiesOverflow.has(bodyType)) {
                state.immersedBodiesOverflow.delete(bodyType);
                btn.classList.remove('immersed');
            } else {
                state.immersedBodiesOverflow.add(bodyType);
                btn.classList.add('immersed');
            }
            
            updateOverflowDisplay();
        }
        
        function updateOverflowDisplay() {
            let totalVolume = 0;
            state.immersedBodiesOverflow.forEach(bodyType => {
                totalVolume += BODIES[bodyType].volume;
            });
            
            // K√∂rper am Boden des √úberlaufgef√§√ües zeichnen
            drawBodiesOverflow(Array.from(state.immersedBodiesOverflow));
            
            const stream = document.getElementById('overflow-stream');
            
            const config = {
                maxVol: CONFIG.overflowMaxVol,
                pxPerMl: CONFIG.overflowPxPerMl,
                topY: CONFIG.overflowTop,
                x: CONFIG.overflowX,
                width: CONFIG.overflowWidth
            };
            
            if (totalVolume > 0) {
                // Wasserstrahl kurz zeigen, dann verstecken
                stream.setAttribute('visibility', 'visible');
                setTimeout(() => {
                    stream.setAttribute('visibility', 'hidden');
                }, 800); // Nach 0.8 Sekunden verstecken
                
                drawWater('water-catch', totalVolume, config, 'waterGradientCatch');
                updateReadLine('readLine-overflow', totalVolume, config);
            } else {
                stream.setAttribute('visibility', 'hidden');
                document.getElementById('water-catch').innerHTML = '';
                document.getElementById('readLine-overflow').setAttribute('visibility', 'hidden');
            }
        }
        
        function drawBodiesOverflow(bodies) {
            const container = document.getElementById('bodies-overflow');
            container.innerHTML = '';
            
            const cx = 75;  // Mitte des √úberlaufgef√§√ües
            const bottomY = CONFIG.ovVesselBottom;  // Boden des √úberlaufgef√§√ües
            let currentY = bottomY;
            
            bodies.forEach(bodyType => {
                const body = BODIES[bodyType];
                
                let shape;
                
                switch(bodyType) {
                    case 'murmel':
                        currentY -= 10;
                        shape = document.createElementNS('http://www.w3.org/2000/svg', 'circle');
                        shape.setAttribute('cx', cx);
                        shape.setAttribute('cy', currentY);
                        shape.setAttribute('r', 10);
                        currentY -= 12;
                        break;
                    case 'w√ºrfel':
                        currentY -= 24;
                        shape = document.createElementNS('http://www.w3.org/2000/svg', 'rect');
                        shape.setAttribute('x', cx - 12);
                        shape.setAttribute('y', currentY);
                        shape.setAttribute('width', 24);
                        shape.setAttribute('height', 24);
                        shape.setAttribute('rx', '2');
                        currentY -= 5;
                        break;
                    case 'kugel':
                        currentY -= 16;
                        shape = document.createElementNS('http://www.w3.org/2000/svg', 'circle');
                        shape.setAttribute('cx', cx);
                        shape.setAttribute('cy', currentY);
                        shape.setAttribute('r', 16);
                        currentY -= 18;
                        break;
                    case 'stein':
                        currentY -= 14;
                        const y = currentY;
                        shape = document.createElementNS('http://www.w3.org/2000/svg', 'path');
                        shape.setAttribute('d', `M ${cx-15} ${y+4} Q ${cx-17} ${y-8} ${cx-4} ${y-12} Q ${cx+8} ${y-14} ${cx+15} ${y-4} Q ${cx+17} ${y+8} ${cx+4} ${y+12} Q ${cx-8} ${y+14} ${cx-15} ${y+4} Z`);
                        currentY -= 16;
                        break;
                }
                
                if (shape) {
                    shape.setAttribute('fill', body.color);
                    shape.setAttribute('stroke', body.stroke);
                    shape.setAttribute('stroke-width', '2');
                    shape.classList.add('body-in-water');
                    container.appendChild(shape);
                }
            });
        }
        
        function checkResultOverflow() {
            const result = parseFloat(document.getElementById('result-overflow').value);
            
            let actualVolume = 0;
            state.immersedBodiesOverflow.forEach(bodyType => {
                actualVolume += BODIES[bodyType].volume;
            });
            
            const feedback = document.getElementById('feedback-overflow');
            
            if (Math.abs(result - actualVolume) <= 0.5) {
                feedback.className = 'feedback correct';
                feedback.innerHTML = `‚úì Richtig! Das Volumen betr√§gt <strong>${actualVolume} ml</strong>.`;
            } else {
                feedback.className = 'feedback incorrect';
                feedback.innerHTML = `‚úó Nicht ganz richtig. Das korrekte Volumen ist ${actualVolume} ml.`;
            }
        }
        
        function resetOverflow() {
            state.immersedBodiesOverflow.clear();
            
            document.querySelectorAll('#√ºberlauf .body-btn').forEach(btn => {
                btn.classList.remove('immersed');
            });
            
            document.getElementById('bodies-overflow').innerHTML = '';
            document.getElementById('water-catch').innerHTML = '';
            document.getElementById('overflow-stream').setAttribute('visibility', 'hidden');
            document.getElementById('readLine-overflow').setAttribute('visibility', 'hidden');
            document.getElementById('result-overflow').value = '';
            document.getElementById('feedback-overflow').className = 'feedback';
            document.getElementById('feedback-overflow').innerHTML = '';
        }
        
        // ============================================
        // START
        // ============================================
        init();
    </script>
</body>
</html>
